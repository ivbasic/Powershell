$ErrorActionPreference = "silentlycontinue"

#------------- FUNCTIONS --------------------------------------------------------------------------------------------------

Function CLI_Loading {
    #Clear-Host
    write-host "SplitExchange running..." -ForegroundColor DarkGreen
    # write-host $text
    # foreach ($line in $text){
    #    Write-Host $line -ForegroundColor DarkGray 
    # }
}

CLI_Loading

Function Datum_Function {
    (Get-Date -format "dd.MM.yyyy HH:mm:ss") 
}

Function Error_Function {
    $Logs.SelectionColor = "DarkRed"
    $Logs.AppendText("$(Get-Date -format "dd.MM.yyyy HH:mm:ss") - Error: $($error[0]) `r`n")
    $Logs.ScrollToCaret()
}



# create a global empty credential object
#$Global:UserCredential = [System.Management.Automation.PSCredential]::Empty


#------------- GENERAL GUI SETTINGS --------------------------------------------------------------------------------------
$sirina = 750
$visina = 700
$ime = "SplitExchange.exe"
$verzija = "check vertsion on cirep/github"

Add-Type -assembly System.Windows.Forms
$main_form = New-Object System.Windows.Forms.Form
$main_form.Text = $ime
$main_form.Width = $sirina
$main_form.Height = $visina
$main_form.Font = New-Object System.Drawing.Font("Verdana", 10)
$main_form.AutoSize = $true
#$main_form.controlbox = $False
$main_form.SizeGripStyle = "Hide"
$main_form.FormBorderStyle = 'Fixed3D'
$main_form.BackColor = "White"
$main_form.DataBindings.DefaultDataSourceUpdateMode = 0


# This base64 string holds the bytes that make up the icon
$iconBase64      = "
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
0uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3
pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPS
JBZG9iZSBYTVAgQ29yZSA1LjYtYzA2NyA3OS4xNTc3NDcsIDIwMTUvMDMvMzAtMjM6NDA6NDIgIC
AgICAgICI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi
8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCi
AgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIC
AgICAgICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgIC
AgICAgICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUm
Vzb3VyY2VFdmVudCMiCiAgICAgICAgICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2
JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm
9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYW
RvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2
JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8eG1wOkNyZWF0b3JUb29sPkFkb2JlIFBob3Rvc2
hvcCBDQyAyMDE1IChXaW5kb3dzKTwveG1wOkNyZWF0b3JUb29sPgogICAgICAgICA8eG1wOkNyZW
F0ZURhdGU+MjAyMi0wNy0xMFQxMjo0NzozMSswMjowMDwveG1wOkNyZWF0ZURhdGU+CiAgICAgIC
AgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMjItMDctMTBUMTI6NDc6MzErMDI6MDA8L3htcDpNZXRhZG
F0YURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4yMDIyLTA3LTEwVDEyOjQ3OjMxKzAyOj
AwPC94bXA6TW9kaWZ5RGF0ZT4KICAgICAgICAgPHhtcE1NOkluc3RhbmNlSUQ+eG1wLmlpZDo4ZW
Y0Y2YwZS1jZWY5LWYxNDctODEwYS0xYTIwMGNhZjg0MDU8L3htcE1NOkluc3RhbmNlSUQ+CiAgIC
AgICAgIDx4bXBNTTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDphYzlhM2QwYi0wMD
NkLTExZWQtYmUwMS1lMjVmNjlkMTVjOTc8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bX
BNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDpiMmIzY2ZjNy1hMTYzLWQ1NDUtYjA5ZC1kMG
EzZjA5YjA1MDg8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3
Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYX
JzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5jcmVhdG
VkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC
5paWQ6YjJiM2NmYzctYTE2My1kNTQ1LWIwOWQtZDBhM2YwOWIwNTA4PC9zdEV2dDppbnN0YW5jZU
lEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDIyLTA3LTEwVDEyOjQ3OjMxKzAyOj
AwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG
9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoV2luZG93cyk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgIC
AgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cG
U9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5zYXZlZDwvc3RFdn
Q6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOjhlZj
RjZjBlLWNlZjktZjE0Ny04MTBhLTFhMjAwY2FmODQwNTwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgIC
AgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAyMi0wNy0xMFQxMjo0NzozMSswMjowMDwvc3RFdn
Q6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG
9zaG9wIENDIDIwMTUgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgIC
AgICAgICA8c3RFdnQ6Y2hhbmdlZD4vPC9zdEV2dDpjaGFuZ2VkPgogICAgICAgICAgICAgICA8L3
JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6U2VxPgogICAgICAgICA8L3htcE1NOkhpc3Rvcnk+Ci
AgICAgICAgIDxwaG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+CiAgICAgICAgICAgIDxyZGY6Qm
FnPgogICAgICAgICAgICAgICA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDozMDZjNzQ3Ny
0wMDNkLTExZWQtYmUwMS1lMjVmNjlkMTVjOTc8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6Qm
FnPgogICAgICAgICA8L3Bob3Rvc2hvcDpEb2N1bWVudEFuY2VzdG9ycz4KICAgICAgICAgPHBob3
Rvc2hvcDpDb2xvck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHBob3Rvc2
hvcDpJQ0NQcm9maWxlPnNSR0IgSUVDNjE5NjYtMi4xPC9waG90b3Nob3A6SUNDUHJvZmlsZT4KIC
AgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHRpZmY6T3
JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb2
4+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dG
lvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdX
Rpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2
U+MTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MzI8L2
V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MzI8L2
V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6Uk
RGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA
ogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCi
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA
ogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCi
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
AgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pn
6IEmAAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAABqpJREFUeN
qkl22MVGcVx3/nee6987I7W5bd5W0tsFkqCFFpUQy2NVlMLbYRjVGJIf1UrTUNNm1CjIY28aX4RS
lWIan0hRRBQltroqhI9UMtVBFalUhFyjsLK8u+z8zOzL33OX6Ymd0Bdhd2PcmTO3OTOf/znPM//3
NGGhbfAYALS6Rnz+XDG55eG+WvrAmHslZElBpT50y6ta0/3dr+Y1cK/6qqWN9y9p1T9Hb1Yz0LCM
BdWsiui/ODGcBxtRPstJlR3N+9c+jw3pc9z/fLAThHUJdellnQvt0E7/cYywRcCeKCW4mY1Wh8SJ
2Sam7Bj+qxnkHE3IX1fyl+0CJ2bDeIEOeHVvbu3fqu15BJozbAhSH1Tc0LTWC9aKh6kbGDEGNm4v
u7tOQ+DXpCnQMXozFLxfd2otqipWFUx/FhLCaRymhYbDNdi9aQ7e8lO9BPNpcDrYCPd0YuIe3WD/
aIyLzKq4XGD36ByNwRJzLBUQciagofWE12+UNIXELUMSkzZqnx/RcRWSFesANjFk3OAeJRHKK46H
60WCLT86e874H4E5SgxmIHIqbDJJL7EVc3fs7HNw9oIRy+pzT/bjPgFz528l8DxFFczuK1VvtOlc
amNI0zUoDUMUXzgKeIoq+SSNLf/jkOvXGxBkxHQbUMOvI9dGSaAzrun4cITD0ARzsoOC2jeKYGSG
oCUFAZ/SyW/FBIoa8ftO6mSjY2B9DwKhAUYoWiGwUXwDflZzU4BZGYaDiH2sQkcRWxPhiLV3U2kv
JImZ60PPDRRpa1phgsxOw9PsTv/pMFc01GYkXjCMwkyKeKBCnCKxcuhF2njnm1N8JBxgqvrGmlo7
2OfOhI+4ZHVkznkV9dZOuBHvBthRuV43QS6VdMIokrDg9d2rpufenSqffMVRkoOTra0nS017HpQA
/t3z/OPdvOUAiVJz7ZQiZly73ndEThFSUquRvHoIr4CVwcFS/99OH12SP7dldJOJr+2JEJDAAtaY
vvG14/OkjH1pO0Tg+IXQ0HHBgPisMR2aiImKAq82Ob9REvcF1b1z0x8OdXnq1tw9F28w1vns5xoT
/kgdunsXpxhgPv5XjhUC+vHu4td4gVqkG7SLncmcNrasQEgpiywl4nImIBHb787KMb+/Y9v/maNt
RRUhk42xvyhZ+f5werZtCxoJ77ljRw35IGXvhLDw/t6SR2o5xxcUxYivENqCo9F/NkB4rXc8J46N
CV4eFs+rc0zgvJdVdIHCJsOPZ7VO8dEZvYIRGIKMvmJFm1MMPDdzYxK+Nx9+YTHDyVh6CcBaMlbr
21RGr2PC52FhjsLkwwRQV8/+8M938WMefoOweHd2BGa6pQjPnmJ5p5+7EFLJuV4G//GOB7u86z5+
1+jBFa0t4oCSsdYKwhO1hisKcAnpRLNNYxgIuWkqjfRSIzg6AOrF/VgUoQkTKUj1namuT5L8/l6V
mXaUob1n6kkYF8xD8782CrGlARFGA4H449O8boBOBOhB2o+xIuHijrQJU4gfDcWz0sbAl4cEUTL6
ydC8DlwZBv7D7P6f8WIGEqWRBuDnXMheRT2GAL6eYHvZF0VnyVFB59tZPnDvZwW3NAFDreuZDnfH
exDD5CQgXnmNIQiCNomLUWa7d5qJqRtbE6z61w9EKeo2dy5XdWIGG5ii869QSAgp+Ec4cbPByKUz
AWbABxsdKgpqwS1TZ1rmYkKzhBnSI6xVmsCjbAQ3UTYh35fjW9J1u9aTM+NMILqTxHSlRbLkO6Ls
YmZ0Ne+H8Wkn34dfs4d4TEkR99sfkzX9/joujGgzxI4DXOwqRvQbQBpHdKNfGwAbgQr/NNvMx0L2
i7HS0VbuKXHqahGRWbLxzY8RrvW/V5bJAiDidFTE/yPfjvvow5+0ek7Q7xZs5HiznKyjHRQhFgkn
Wu62ePPZndv/0nLD/2b+598ruoCi6++QCSrz+OaIxLTQPfNzZZX26K8caaglgPk6yn68Vvbezbv3
0zEHNo+w9J3dLIyvWPUxisTqWJiggixtOovJFpWISwlBc/AdUSyFjgBpPK0L174zM9r216ioomAg
XeeOY7JDINfPxrX6GUA43HLodYMD44N2zjwV7i/m7igW6i3kt9ibmLlwVz2ttw0WjLVY+AIFHPr7
dsu/zShm8DuWtcFzl98ADpxjnMXvJB1MnInll7vACO/+E3HNm55brwJJG6LZjZthQw6DX/NESMRm
GudPHEW8CV8bNrZtM0fznGS6HX1UJAHH1nDhOVTsvYxcFOLGPcDMvsDdohAvjfAJJfNVuoS6dsAA
AAAElFTkSuQmCC
"

$iconBytes       = [Convert]::FromBase64String($iconBase64)
# initialize a Memory stream holding the bytes
$stream          = [System.IO.MemoryStream]::new($iconBytes, 0, $iconBytes.Length)
$main_form.Icon       = [System.Drawing.Icon]::FromHandle(([System.Drawing.Bitmap]::new($stream).GetHIcon()))


# TAB CONTROL
$Tab_control = New-object System.Windows.Forms.TabControl
$Tab_control.Location = New-Object System.Drawing.Point(0,0) 
$Tab_control.Name = "tabControl"
$Tab_control.Borderstyle = "none"
$Tab_control.size = New-Object System.Drawing.Size(($sirina-20),($visina -180))
$main_form.Controls.Add($Tab_control)
#$main_form.BackColor = "LightGray"


# TAB 1 - mailboxes
$Tab1_mailboxes = New-Object System.Windows.Forms.TabPage
$Tab1_mailboxes.DataBindings.DefaultDataSourceUpdateMode = 0
$Tab1_mailboxes.UseVisualStyleBackColor = $True
$Tab1_mailboxes.TabIndex = 0
$Tab1_mailboxes.Name = "mailboxes" 
$Tab1_mailboxes.Text = "   mailboxes   " 
$Tab1_mailboxes.BackColor = "White"
$Tab1_mailboxes.ForeColor = "Black"
$Tab_control.Controls.Add($Tab1_mailboxes)

# TAB 2 - groups
$Tab2_groups = New-Object System.Windows.Forms.TabPage
$Tab2_groups.DataBindings.DefaultDataSourceUpdateMode = 0
$Tab2_groups.UseVisualStyleBackColor = $True
$Tab2_groups.TabIndex = 1
$Tab2_groups.Name = "groups"
$Tab2_groups.Text = "   groups   "
$Tab2_groups.BackColor = "White"
$Tab2_groups.ForeColor = "Black"
$Tab_control.Controls.Add($Tab2_groups)

# TAB 3 - resources
$Tab3_resources = New-Object System.Windows.Forms.TabPage
$Tab3_resources.DataBindings.DefaultDataSourceUpdateMode = 0
$Tab3_resources.UseVisualStyleBackColor = $True
$Tab3_resources.TabIndex = 2
$Tab3_resources.Name = "resources"
$Tab3_resources.Text = "   resources   "
$Tab3_resources.BackColor = "White"
$Tab3_resources.ForeColor = "Black"
$Tab_control.Controls.Add($Tab3_resources)

# TAB 4 - contacts
$Tab4_contacts = New-Object System.Windows.Forms.TabPage
$Tab4_contacts.DataBindings.DefaultDataSourceUpdateMode = 0
$Tab4_contacts.UseVisualStyleBackColor = $True
$Tab4_contacts.TabIndex = 3
$Tab4_contacts.Name = "contacts"
$Tab4_contacts.Text = "   contacts   "
$Tab4_contacts.BackColor = "White"
$Tab4_contacts.ForeColor = "Black"
$Tab_control.Controls.Add($Tab4_contacts)

# TAB 5 - convert
$Tab5_convert = New-Object System.Windows.Forms.TabPage
$Tab5_convert.DataBindings.DefaultDataSourceUpdateMode = 0
$Tab5_convert.UseVisualStyleBackColor = $True
$Tab5_convert.TabIndex = 4
$Tab5_convert.Name = "convert"
$Tab5_convert.Text = "   convert   "
$Tab5_convert.BackColor = "White"
$Tab5_convert.ForeColor = "Black"
$Tab_control.Controls.Add($Tab5_convert)

# TAB 6 - migration
$Tab6_migration = New-Object System.Windows.Forms.TabPage
$Tab6_migration.DataBindings.DefaultDataSourceUpdateMode = 0
$Tab6_migration.UseVisualStyleBackColor = $True
$Tab6_migration.TabIndex = 5
$Tab6_migration.Name = "migration"
$Tab6_migration.Text = "   migration   "
$Tab6_migration.BackColor = "White"
$Tab6_migration.ForeColor = "Black"
$Tab_control.Controls.Add($Tab6_migration)

# TAB 7 - about
$Tab7_about = New-Object System.Windows.Forms.TabPage
$Tab7_about.DataBindings.DefaultDataSourceUpdateMode = 0
$Tab7_about.UseVisualStyleBackColor = $True
$Tab7_about.TabIndex = 6
$Tab7_about.Name = "about"
$Tab7_about.Text = "   about   "
$Tab7_about.BackColor = "White"
$Tab7_about.ForeColor = "Black"
$Tab_control.Controls.Add($Tab7_about)

# Logs text box
$Logs = New-Object System.Windows.Forms.RichTextBox
$Logs.Location = New-Object System.Drawing.Size(10,530) 
$Logs.Size = New-Object System.Drawing.Size('710,100')
$Logs.Font = New-Object System.Drawing.Font("Consolas",8,[System.Drawing.FontStyle]::Italic)
$Logs.BackColor = "White"
$Logs.Enabled = $True 
$Logs.Multiline = $True 
$Logs.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e0e0e0")   #"LightGray" 
$Logs.ScrollBars = "vertical"
$Logs.Text = ""
$main_form.Controls.Add($Logs) 

# Create music process
$psi = New-object System.Diagnostics.ProcessStartInfo 
$psi.CreateNoWindow = $true 
$psi.UseShellExecute = $false 
$psi.RedirectStandardOutput = $true 
$psi.RedirectStandardError = $true 
$psi.FileName = "powershell.exe" 
# https://www.undocumented-features.com/2020/10/23/announcing-the-end-of-a-script-with-a-powershell-music/
$psi.Arguments = "
[console]::beep(440,500) 
[console]::beep(440,500)
[console]::beep(440,500) 
[console]::beep(349,350) 
[console]::beep(523,150) 
[console]::beep(440,500) 
[console]::beep(349,350) 
[console]::beep(523,150) 
[console]::beep(440,1000)
[console]::beep(659,500) 
[console]::beep(659,500) 
[console]::beep(659,500) 
[console]::beep(698,350) 
[console]::beep(523,150) 
[console]::beep(415,500) 
[console]::beep(349,350) 
[console]::beep(523,150) 
[console]::beep(440,1000)
"
$MusicProcess = New-Object System.Diagnostics.Process 
$MusicProcess.StartInfo = $psi 

# Toggle music button
$Toggle_Music_Button = New-Object System.Windows.Forms.Button
$Toggle_Music_Button.Location = New-Object System.Drawing.Size(30,637)
$Toggle_Music_Button.Size = New-Object System.Drawing.Size(23,23)
$Toggle_Music_Button.Text = "â™«" 
$Toggle_Music_Button.BackColor = "White"
$Toggle_Music_Button.TabIndex = 0
$Toggle_Music_Button.Enabled = $True
$Toggle_Music_Button.Add_Click({ 
    if ($Toggle_Music_Button.BackColor -eq "White"){
        $Toggle_Music_Button.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
        $MusicProcess.Start() |  Out-Null
        }
    else {
        $Toggle_Music_Button.BackColor = "White"
        $MusicProcess.kill()
        }
})
$main_form.Controls.Add($Toggle_Music_Button) 

# Disconnect & Exit button
$Mailbox_ExitButton = New-Object System.Windows.Forms.Button
$Mailbox_ExitButton.Location = New-Object System.Drawing.Point(210,637)
$Mailbox_ExitButton.Size = New-Object System.Drawing.Size(300,23)
$Mailbox_ExitButton.TabIndex = 0
$Mailbox_ExitButton.Text = "Disconnect Exchange sessions and exit"
$Mailbox_ExitButton.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#ffeadf")
#"Bisque"

#$Mailbox_ExitButton.foreColor = "DarkRed"
$Mailbox_ExitButton.Add_Click({
    $Logs.AppendText("$(Datum_Function) - Removing Exchange connections and closing SplitExchange... `r`n");
    $Logs.ScrollToCaret()
    Get-PSSession | Where-Object {$_.ConfigurationName -eq "Microsoft.Exchange"} | Remove-PSSession; 
    $main_form.Close(); 
    write-host "SplitExchange stopping..." -ForegroundColor "Yellow"
    #Stop-Transcript
})
$main_form.Controls.Add($Mailbox_ExitButton) 

# Credits
$CreditsURL = New-Object System.Windows.Forms.LinkLabel
$CreditsURL.Text = "github.com/ivbasic"
$CreditsURL.LinkColor = "darkGray"
$CreditsURL.ActiveLinkColor = "darkGray"
$CreditsURL.Location = New-Object System.Drawing.Point(600,642)
$CreditsURL.Font = New-Object System.Drawing.Font("Verdana",8,[System.Drawing.FontStyle]::Italic)
$CreditsURL.AutoSize = $true
$CreditsURL.add_Click({[system.Diagnostics.Process]::start("https://github.com/ivbasic")})
$main_form.Controls.Add($CreditsURL)


#------------- TAB 1 - mailboxes --------------------------------------------------------------------------------------------
<#
# Group Box
$Tab1_mailboxes = New-Object System.Windows.Forms.GroupBox
$Tab1_mailboxes.Location = New-Object System.Drawing.Point(15,10) 
$Tab1_mailboxes.size = New-Object System.Drawing.Size(720,430)
$Tab1_mailboxes.Text = "new mailbox (user/shared/room)"
$Tab1_mailboxes.ScrollBars = "Vertical" 
$Tab1_mailboxes.Multiline = $true
$Tab1_mailboxes.AutoScroll = $true 
$Tab1_mailboxes.Controls.Add($Tab1_mailboxes) 
#>
# Panel (for scoll bar to work)
$Tab1_mailboxes_Panel_1 = New-Object System.Windows.Forms.Panel
$Tab1_mailboxes_Panel_1.Location = New-Object System.Drawing.Point(15,20) 
$Tab1_mailboxes_Panel_1.size = New-Object System.Drawing.Size(700,420)
$Tab1_mailboxes_Panel_1.Dock = "Fill" 
$Tab1_mailboxes_Panel_1.ColumnCount = 0
$Tab1_mailboxes_Panel_1.RowCount = 0
$Tab1_mailboxes_Panel_1.BorderStyle = "None"
$Tab1_mailboxes_Panel_1.AutoSize = $true
$Tab1_mailboxes_Panel_1.AutoScroll = $true
$Tab1_mailboxes_Panel_1.Multiline = $true
$Tab1_mailboxes_Panel_1.ScrollBars = "vertical"
#$Tab1_mailboxes_Panel_1.BackColor = "Pink"
$Tab1_mailboxes.controls.add($Tab1_mailboxes_Panel_1)

# Mailbox image
$Mailbox_iconBase64 = "
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
"
$Mailbox_iconBytes = [Convert]::FromBase64String($Mailbox_iconBase64)
# initialize a Memory stream holding the bytes
#$Maibox_stream = [System.IO.MemoryStream]::new($Mailbox_iconBytes, 0, $Mailbox_iconBytes.Length)
#$Tab1_mailboxes_Panel_1.Icon  = [System.Drawing.Icon]::FromHandle(([System.Drawing.Bitmap]::new($Maibox_stream).GetHIcon()))

$Mailbox_PictureBox = new-object Windows.Forms.PictureBox
$Mailbox_PictureBox.Location = New-Object System.Drawing.Size(570,30)
$Mailbox_PictureBox.Size = New-Object System.Drawing.Size(100,100)
$Mailbox_PictureBox.Image = $Mailbox_iconBytes
$Tab1_mailboxes_Panel_1.controls.add($Mailbox_PictureBox)

# inside Panel
$Mailbox_alias = New-Object System.Windows.Forms.Label
$Mailbox_alias.Location = New-Object System.Drawing.Point(15,10)
$Mailbox_alias.AutoSize = $true
$Mailbox_alias.TabIndex = 0
$Mailbox_alias.Text = "Alias:"
$Mailbox_alias.ForeColor = "Black"
$Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_alias)

$Mailbox_aliastextbox = New-Object System.Windows.Forms.TextBox
$Mailbox_aliastextbox.Location = New-Object System.Drawing.Point(15,35)
$Mailbox_aliastextbox.Size = New-Object System.Drawing.Size(500,30)
$Mailbox_aliastextbox.TabIndex = 0
$Mailbox_aliastextbox.Text = "HR."
$Mailbox_aliastextbox.ForeColor = "Blue"
$Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_aliastextbox)

$Mailbox_ExistingUserCheckbox = New-Object System.Windows.Forms.Checkbox 
$Mailbox_ExistingUserCheckbox.Location = New-Object System.Drawing.Point(15,70)
$Mailbox_ExistingUserCheckbox.AutoSize = $true
$Mailbox_ExistingUserCheckbox.TabIndex = 0
$Mailbox_ExistingUserCheckbox.Text = "Mail enable existing AD user"
$Mailbox_ExistingUserCheckbox.ForeColor = "Black"
$Mailbox_ExistingUserCheckbox.add_CheckedChanged({Mailbox_ExistingUserCheckbox_function})
$Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_ExistingUserCheckbox)

$Mailbox_ExistingUserCheckboxInfo = New-Object System.Windows.Forms.Label
$Mailbox_ExistingUserCheckboxInfo.Location = New-Object System.Drawing.Point(540,150)
$Mailbox_ExistingUserCheckboxInfo.Size = New-Object System.Drawing.Size(160,300)
$Mailbox_ExistingUserCheckboxInfo.TabIndex = 0
$Mailbox_ExistingUserCheckboxInfo.Text = "Use this option to create mailboxes for existing users who don't already have mailboxes."
$Mailbox_ExistingUserCheckboxInfo.ForeColor = "Gray"
#$Mailbox_ExistingUserCheckboxInfo.backColor = "Pink"

$Mailbox_ExistingUserLabel = New-Object System.Windows.Forms.Label
$Mailbox_ExistingUserLabel.Location = New-Object System.Drawing.Point(15,100)
$Mailbox_ExistingUserLabel.Size = New-Object System.Drawing.Size(250,20)
$Mailbox_ExistingUserLabel.TabIndex = 0
$Mailbox_ExistingUserLabel.Text = "samaccountname:"
$Mailbox_ExistingUserLabel.ForeColor = "Black"

$Mailbox_ExistingUserTextBox = New-Object System.Windows.Forms.TextBox
$Mailbox_ExistingUserTextBox.Location = New-Object System.Drawing.Point(15,120)
$Mailbox_ExistingUserTextBox.Size = New-Object System.Drawing.Size(300,30)
$Mailbox_ExistingUserTextBox.TabIndex = 0
$Mailbox_ExistingUserTextBox.ForeColor = "Blue"

$Mailbox_ExistingUserCheckButton = New-Object System.Windows.Forms.Button
$Mailbox_ExistingUserCheckButton.Location = New-Object System.Drawing.Point(350,120)
$Mailbox_ExistingUserCheckButton.Size = New-Object System.Drawing.Size(165,23)
$Mailbox_ExistingUserCheckButton.TabIndex = 0
$Mailbox_ExistingUserCheckButton.Text = "Get-ADUser"
$Mailbox_ExistingUserCheckButton.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Mailbox_ExistingUserCheckButton.Add_Click({Get-ADUser_function})
function Mailbox_ExistingUserCheckbox_function(){
    if ($Mailbox_ExistingUserCheckbox.checked -eq $true){
        $Mailbox_NewUserCheckbox.Enabled = $false
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_ExistingUserLabel)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_ExistingUserTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_ExistingUserCheckButton)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_ExistingUserCheckboxInfo)
        
        $Tab1_mailboxes_Panel_1.Controls.Add($Create_Mailbox_Button_Existing) 
        }
    else {
        $Mailbox_NewUserCheckbox.Enabled = $true
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_ExistingUserTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_ExistingUserLabel)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_ExistingUserCheckButton)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_ExistingUserCheckboxInfo)

        $Tab1_mailboxes_Panel_1.Controls.Remove($Create_Mailbox_Button_Existing) 
    }
}
function Get-ADUser_function(){
    try {
        if (($Mailbox_ExistingUserTextBox.Text) -and ($Tab_control.SelectedIndex -eq 0)){
            $Mailbox_ADuser = get-aduser ($Mailbox_ExistingUserTextBox.Text); 
            $Logs.AppendText("$(Datum_Function) - OK - $Mailbox_ADuser.DistinguishedName`r`n")
            $Logs.ScrollToCaret()
        }
        if (($Group_OwnerNameTextBox.Text) -and ($Tab_control.SelectedIndex -eq 1)){
            $Group_ADuser = get-aduser ($Group_OwnerNameTextBox.Text); 
            $Logs.AppendText("$(Datum_Function) - OK - $Group_ADuser.DistinguishedName`r`n")
            $Logs.ScrollToCaret()
        }
        if (($Contact_ExistingMailUserTextBox.Text) -and ($Tab_control.SelectedIndex -eq 3)){
            $Contact_ADuser = get-aduser ($Contact_ExistingMailUserTextBox.Text); 
            $Logs.AppendText("$(Datum_Function) - OK - $Contact_ADuser.DistinguishedName`r`n")
            $Logs.ScrollToCaret()
        }
    }
    catch {
        Error_Function
    } 
}

$Mailbox_NewUserCheckbox = New-Object System.Windows.Forms.Checkbox 
$Mailbox_NewUserCheckbox.Location = New-Object System.Drawing.Point(350,70)
$Mailbox_NewUserCheckbox.AutoSize = $true
$Mailbox_NewUserCheckbox.TabIndex = 0
$Mailbox_NewUserCheckbox.Text = "New user mailbox"
$Mailbox_NewUserCheckbox.ForeColor = "Black"
$Mailbox_NewUserCheckbox.add_CheckedChanged({Mailbox_NewUserCheckbox_function})
$Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_NewUserCheckbox)

$Mailbox_NewUserCheckboxInfo = New-Object System.Windows.Forms.Label
$Mailbox_NewUserCheckboxInfo.Location = New-Object System.Drawing.Point(540,150)
$Mailbox_NewUserCheckboxInfo.Size = New-Object System.Drawing.Size(160,300)
$Mailbox_NewUserCheckboxInfo.TabIndex = 0
$Mailbox_NewUserCheckboxInfo.Text = "Use this option to create mailboxes and user accounts at the same time. 

'Department' attribute should be filled with email address of an owner if you're creating non-user account. 

'c' attribute is automatically filled with value 'HR'."
$Mailbox_NewUserCheckboxInfo.ForeColor = "Gray"


$Mailbox_FirstNameLabel = New-Object System.Windows.Forms.Label
$Mailbox_FirstNameLabel.Location = New-Object System.Drawing.Point(15,100)
$Mailbox_FirstNameLabel.Size = New-Object System.Drawing.Size(250,20)
$Mailbox_FirstNameLabel.TabIndex = 0
$Mailbox_FirstNameLabel.Text = "First name:"
$Mailbox_FirstNameLabel.ForeColor = "Black"

$Mailbox_FirstNameTextBox= New-Object System.Windows.Forms.TextBox 
$Mailbox_FirstNameTextBox.Location = New-Object System.Drawing.Point(15,120)
$Mailbox_FirstNameTextBox.Size = New-Object System.Drawing.Size(500,30)
$Mailbox_FirstNameTextBox.TabIndex = 0
$Mailbox_FirstNameTextBox.ForeColor = "Blue"
$Mailbox_FirstNameTextBox.Add_Validating({
    $Mailbox_DisplayNameTextBox.Text = $Mailbox_FirstNameTextBox.Text + " " + $Mailbox_LastNameTextBox.Text
})

$Mailbox_LastNameLabel = New-Object System.Windows.Forms.Label
$Mailbox_LastNameLabel.Location = New-Object System.Drawing.Point(15,145)
$Mailbox_LastNameLabel.Size = New-Object System.Drawing.Size(250,20)
$Mailbox_LastNameLabel.TabIndex = 0
$Mailbox_LastNameLabel.Text = "Last name:"
$Mailbox_LastNameLabel.ForeColor = "Black"

$Mailbox_LastNameTextBox= New-Object System.Windows.Forms.TextBox 
$Mailbox_LastNameTextBox.Location = New-Object System.Drawing.Point(15,165)
$Mailbox_LastNameTextBox.Size = New-Object System.Drawing.Size(500,30)
$Mailbox_LastNameTextBox.TabIndex = 0
$Mailbox_LastNameTextBox.ForeColor = "Blue"
$Mailbox_LastNameTextBox.Add_Validating({
    $Mailbox_DisplayNameTextBox.Text = $Mailbox_FirstNameTextBox.Text + " " + $Mailbox_LastNameTextBox.Text
})

$Mailbox_DisplayNameLabel = New-Object System.Windows.Forms.Label
$Mailbox_DisplayNameLabel.Location = New-Object System.Drawing.Point(15,190)
$Mailbox_DisplayNameLabel.Size = New-Object System.Drawing.Point(250,20)
$Mailbox_DisplayNameLabel.TabIndex = 0
$Mailbox_DisplayNameLabel.Text = "Display name:"
$Mailbox_DisplayNameLabel.ForeColor = "Black"

$Mailbox_DisplayNameTextBox= New-Object System.Windows.Forms.TextBox 
$Mailbox_DisplayNameTextBox.Location = New-Object System.Drawing.Point(15,210)
$Mailbox_DisplayNameTextBox.Size = New-Object System.Drawing.Size(500,30)
$Mailbox_DisplayNameTextBox.TabIndex = 0
$Mailbox_DisplayNameTextBox.ForeColor = "Blue"

$Mailbox_OrganizationalUnitLabel = New-Object System.Windows.Forms.Label
$Mailbox_OrganizationalUnitLabel.Location = New-Object System.Drawing.Point(15,235)
$Mailbox_OrganizationalUnitLabel.Size = New-Object System.Drawing.Point(250,20)
$Mailbox_OrganizationalUnitLabel.TabIndex = 0
$Mailbox_OrganizationalUnitLabel.Text = "Organizational unit:"
$Mailbox_OrganizationalUnitLabel.ForeColor = "Black"

$Mailbox_OrganizationalUnitDropMenu= New-Object System.Windows.Forms.ComboBox
$Mailbox_OrganizationalUnitDropMenu.Location = New-Object System.Drawing.Point(15,255)
$Mailbox_OrganizationalUnitDropMenu.Size = New-Object System.Drawing.Size(500,30)
$Mailbox_OrganizationalUnitDropMenu.TabIndex = 0
$Mailbox_OrganizationalUnitDropMenu.ForeColor = "Blue"
$Mailbox_OrganizationalUnitDropMenu.Height = 80

[void] $Mailbox_OrganizationalUnitDropMenu.Items.Add('atl-dc-001')
[void] $Mailbox_OrganizationalUnitDropMenu.Items.Add('atl-dc-002')
[void] $Mailbox_OrganizationalUnitDropMenu.Items.Add('atl-dc-003')
[void] $Mailbox_OrganizationalUnitDropMenu.Items.Add('atl-dc-004')
[void] $Mailbox_OrganizationalUnitDropMenu.Items.Add('atl-dc-005')
[void] $Mailbox_OrganizationalUnitDropMenu.Items.Add('atl-dc-006')
[void] $Mailbox_OrganizationalUnitDropMenu.Items.Add('atl-dc-007')

$Mailbox_UPNLabel = New-Object System.Windows.Forms.Label
$Mailbox_UPNLabel.Location = New-Object System.Drawing.Point(15,280)
$Mailbox_UPNLabel.Size = New-Object System.Drawing.Point(250,20)
$Mailbox_UPNLabel.TabIndex = 0
$Mailbox_UPNLabel.Text = "User logon name:"
$Mailbox_UPNLabel.ForeColor = "Black"

$Mailbox_UPNTextBox= New-Object System.Windows.Forms.TextBox 
$Mailbox_UPNTextBox.Location = New-Object System.Drawing.Point(15,300)
$Mailbox_UPNTextBox.Size = New-Object System.Drawing.Size(300,30)
$Mailbox_UPNTextBox.TabIndex = 0
$Mailbox_UPNTextBox.ForeColor = "Blue"

$Mailbox_UPNDomainTextBox= New-Object System.Windows.Forms.TextBox 
$Mailbox_UPNDomainTextBox.Location = New-Object System.Drawing.Point(350,300)
$Mailbox_UPNDomainTextBox.Size = New-Object System.Drawing.Size(165,25)
$Mailbox_UPNDomainTextBox.TabIndex = 0
$Mailbox_UPNDomainTextBox.enabled = $false
$Mailbox_UPNDomainTextBox.Text = "@domain.com"
$Mailbox_UPNDomainTextBox.ForeColor = "Blue"

$Mailbox_DescriptionLabel = New-Object System.Windows.Forms.Label
$Mailbox_DescriptionLabel.Location = New-Object System.Drawing.Point(15,325)
$Mailbox_DescriptionLabel.Size = New-Object System.Drawing.Point(250,20)
$Mailbox_DescriptionLabel.TabIndex = 0
$Mailbox_DescriptionLabel.Text = "Description:"
$Mailbox_DescriptionLabel.ForeColor = "Black"

$Mailbox_DescriptionTextBox= New-Object System.Windows.Forms.TextBox 
$Mailbox_DescriptionTextBox.Location = New-Object System.Drawing.Point(15,345)
$Mailbox_DescriptionTextBox.Size = New-Object System.Drawing.Size(500,30)
$Mailbox_DescriptionTextBox.TabIndex = 0
$Mailbox_DescriptionTextBox.ForeColor = "Blue"

$Mailbox_DepartmentLabel = New-Object System.Windows.Forms.Label
$Mailbox_DepartmentLabel.Location = New-Object System.Drawing.Point(15,370)
$Mailbox_DepartmentLabel.Size = New-Object System.Drawing.Point(250,20)
$Mailbox_DepartmentLabel.TabIndex = 0
$Mailbox_DepartmentLabel.Text = "Department:"
$Mailbox_DepartmentLabel.ForeColor = "Black"

$Mailbox_DepartmentTextBox= New-Object System.Windows.Forms.TextBox 
$Mailbox_DepartmentTextBox.Location = New-Object System.Drawing.Point(15,390)
$Mailbox_DepartmentTextBox.Size = New-Object System.Drawing.Size(500,30)
$Mailbox_DepartmentTextBox.TabIndex = 0
$Mailbox_DepartmentTextBox.ForeColor = "Blue"

$Mailbox_MailboxTypeLabel = New-Object System.Windows.Forms.Label
$Mailbox_MailboxTypeLabel.Location = New-Object System.Drawing.Point(15,415)
$Mailbox_MailboxTypeLabel.Size = New-Object System.Drawing.Point(250,20)
$Mailbox_MailboxTypeLabel.TabIndex = 0
$Mailbox_MailboxTypeLabel.Text = "Mailbox type:"
$Mailbox_MailboxTypeLabel.ForeColor = "Black"

$Mailbox_MailboxTypeDropMenu= New-Object System.Windows.Forms.ComboBox
$Mailbox_MailboxTypeDropMenu.Location = New-Object System.Drawing.Point(15,435)
$Mailbox_MailboxTypeDropMenu.Size = New-Object System.Drawing.Size(500,30)
$Mailbox_MailboxTypeDropMenu.TabIndex = 0
$Mailbox_MailboxTypeDropMenu.SelectedIndex = 0
$Mailbox_MailboxTypeDropMenu.ForeColor = "Blue"
$Mailbox_MailboxTypeDropMenu.Height = 80

[void] $Mailbox_MailboxTypeDropMenu.Items.Add('User mailbox')
[void] $Mailbox_MailboxTypeDropMenu.Items.Add('Shared mailbox')
[void] $Mailbox_MailboxTypeDropMenu.Items.Add('Room mailbox')

$Mailbox_Password1Label = New-Object System.Windows.Forms.Label
$Mailbox_Password1Label.Location = New-Object System.Drawing.Point(15,460)
$Mailbox_Password1Label.Size = New-Object System.Drawing.Point(250,20)
$Mailbox_Password1Label.TabIndex = 0
$Mailbox_Password1Label.Text = "New password:"
$Mailbox_Password1Label.ForeColor = "Black"

$Mailbox_Password1TextBox= New-Object System.Windows.Forms.MaskedTextBox
$Mailbox_Password1TextBox.Location = New-Object System.Drawing.Point(15,480)
$Mailbox_Password1TextBox.Size = New-Object System.Drawing.Size(500,30)
$Mailbox_Password1TextBox.PasswordChar = '*'
$Mailbox_Password1TextBox.TabIndex = 0
$Mailbox_Password1TextBox.ForeColor = "Blue"
$Mailbox_Password1TextBox.Height = 80

$Mailbox_Password2Label = New-Object System.Windows.Forms.Label
$Mailbox_Password2Label.Location = New-Object System.Drawing.Point(15,505)
$Mailbox_Password2Label.Size = New-Object System.Drawing.Point(250,20)
$Mailbox_Password2Label.TabIndex = 0
$Mailbox_Password2Label.Text = "Confirm password:"
$Mailbox_Password2Label.ForeColor = "Black"

$Mailbox_Password2TextBox= New-Object System.Windows.Forms.MaskedTextBox
$Mailbox_Password2TextBox.Location = New-Object System.Drawing.Point(15,525)
$Mailbox_Password2TextBox.Size = New-Object System.Drawing.Size(500,30)
$Mailbox_Password2TextBox.PasswordChar = '*'
$Mailbox_Password2TextBox.TabIndex = 0
$Mailbox_Password2TextBox.ForeColor = "Blue"
$Mailbox_Password2TextBox.Height = 80

$Mailbox_PasswordMustChange = New-Object System.Windows.Forms.Checkbox 
$Mailbox_PasswordMustChange.Location = New-Object System.Drawing.Point(15,560) 
$Mailbox_PasswordMustChange.AutoSize = $true
$Mailbox_PasswordMustChange.TabIndex = 0
$Mailbox_PasswordMustChange.Text = "User must change password at next logon"
$Mailbox_PasswordMustChange.ForeColor = "Black"

$Mailbox_UserDisabled = New-Object System.Windows.Forms.Checkbox 
$Mailbox_UserDisabled.Location = New-Object System.Drawing.Point(15,585) 
$Mailbox_UserDisabled.AutoSize = $true
$Mailbox_UserDisabled.TabIndex = 0
$Mailbox_UserDisabled.Text = "User is disabled"
$Mailbox_UserDisabled.ForeColor = "Black"
$Mailbox_MailboxTypeDropMenu.add_SelectedIndexChanged({
    if ($Mailbox_MailboxTypeDropMenu.SelectedIndex -eq "1"){ 
        $Mailbox_UserDisabled.checked = $True
        $Mailbox_Password1TextBox.enabled = $False
        $Mailbox_Password2TextBox.enabled = $False
        $Mailbox_Password1TextBox.text = "********************"
        $Mailbox_Password2TextBox.text = "********************"
    }
    else {
        $Mailbox_UserDisabled.checked = $False
        $Mailbox_Password1TextBox.enabled = $True
        $Mailbox_Password2TextBox.enabled = $True
        $Mailbox_Password1TextBox.text = ""
        $Mailbox_Password2TextBox.text = ""
    }
    })

# Create mailbox button - Existing
$Create_Mailbox_Button_Existing = New-Object System.Windows.Forms.Button
$Create_Mailbox_Button_Existing.Location = New-Object System.Drawing.Size(210,465)
$Create_Mailbox_Button_Existing.Size = New-Object System.Drawing.Size(300,23)
$Create_Mailbox_Button_Existing.Text = "Create mailbox"
$Create_Mailbox_Button_Existing.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Create_Mailbox_Button_Existing.ForeColor = "Black"
$Create_Mailbox_Button_Existing.TabIndex = 0
$Create_Mailbox_Button_Existing.Enabled = $True
$Create_Mailbox_Button_Existing.Add_Click({ Exchange_Connection; Create_Mailbox })

# Create mailbox button - New
$Create_Mailbox_Button_New = New-Object System.Windows.Forms.Button
$Create_Mailbox_Button_New.Location = New-Object System.Drawing.Size(210,610)
$Create_Mailbox_Button_New.Size = New-Object System.Drawing.Size(300,23)
$Create_Mailbox_Button_New.Text = "Create mailbox"
$Create_Mailbox_Button_New.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Create_Mailbox_Button_New.ForeColor = "Black"
$Create_Mailbox_Button_New.TabIndex = 0
$Create_Mailbox_Button_New.Enabled = $True
$Create_Mailbox_Button_New.Add_Click({ Exchange_Connection; write-host "1"; Create_Mailbox; write-host "2" })


function Exchange_Connection(){
    if (!(Get-PSSession | Where-Object {($_.ConfigurationName -eq "Microsoft.Exchange") -and ($_.State -eq "Opened")})){
        try {
            $Logs.AppendText("$(Datum_Function) - Connecting to Exchange, please wait... `r`n")
            $Logs.ScrollToCaret()
            $AdminCredentials = Get-Credential u2927a
            $Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://server.domain.com/PowerShell/ -Authentication Kerberos -Credential $AdminCredentials
            Import-PSSession $Session -DisableNameChecking
            $Logs.AppendText("$(Datum_Function) - Connected to Exchange. `r`n")
            $Logs.ScrollToCaret()
            #Add-PSSnapin Microsoft.Exchange.Management.PowerShell.SnapIn
        }
        catch {
            Error_Function
        }
    }
    else {
        $Logs.AppendText("$(Datum_Function) - Already connected to Exchange. `r`n")
        $Logs.ScrollToCaret()
    }
}


function Create_ExistingMailbox(){
    Try {
        write-host "AAAA"

        Enable-Mailbox -identity ($Mailbox_ExistingUserTextBox.Text) -alias ($Mailbox_aliastextbox.Text) | Out-Null
        #$x = (return $_).tostring()
        #$Existing_Mailbox = (get-mailbox ($Mailbox_aliastextbox.Text)).primarysmtpaddress
        $Logs.AppendText("$(Datum_Function) - Mailbox created! `r`n")
        $Logs.ScrollToCaret()
    }
    catch {
        Error_Function
    }
}

function Create_NewMailbox(){
    write-host "new"
    
}
function Create_Mailbox_function(){
    write-host "create"
    
    if ($Mailbox_NewUserCheckbox.checked -eq $true){
        Create_NewMailbox
    }
    if ($Mailbox_ExistingUserCheckbox.checked -eq $true){
        Create_ExistingMailbox
    }
}

function Mailbox_NewUserCheckbox_function(){
    if ($Mailbox_NewUserCheckbox.checked -eq $true){
        $Mailbox_ExistingUserCheckbox.Enabled = $false
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_NewUserCheckboxInfo)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_FirstNameLabel)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_FirstNameTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_LastNameLabel)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_LastNameTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_DisplayNameLabel)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_DisplayNameTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_OrganizationalUnitLabel)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_OrganizationalUnitDropMenu)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_UPNLabel)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_UPNTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_UPNDomainTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_DescriptionLabel)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_DescriptionTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_DepartmentLabel)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_DepartmentTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_MailboxTypeLabel)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_MailboxTypeDropMenu)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_Password1Label)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_Password1TextBox)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_Password2Label)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_Password2TextBox)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_PasswordMustChange)
        $Tab1_mailboxes_Panel_1.Controls.Add($Mailbox_UserDisabled)

        $Tab1_mailboxes_Panel_1.Controls.Add($Create_Mailbox_Button_New) 

        }
    else {
        $Mailbox_ExistingUserCheckbox.Enabled = $true
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_NewUserCheckboxInfo)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_FirstNameLabel)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_FirstNameTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_LastNameLabel)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_LastNameTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_DisplayNameLabel)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_DisplayNameTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_OrganizationalUnitLabel)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_OrganizationalUnitDropMenu)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_UPNLabel)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_UPNTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_UPNDomainTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_DescriptionLabel)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_DescriptionTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_DepartmentLabel)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_DepartmentTextBox)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_MailboxTypeLabel)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_MailboxTypeDropMenu)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_Password1Label)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_Password1TextBox)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_Password2Label)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_Password2TextBox)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_PasswordMustChange)
        $Tab1_mailboxes_Panel_1.Controls.Remove($Mailbox_UserDisabled)

        $Tab1_mailboxes_Panel_1.Controls.Remove($Create_Mailbox_Button_New) 
    }
}


#------------- TAB 2 - groups --------------------------------------------------------------------------------------------

# Panel (for scoll bar to work)
$Tab2_groups_Panel_1 = New-Object System.Windows.Forms.Panel
$Tab2_groups_Panel_1.Location = New-Object System.Drawing.Point(15,20) 
$Tab2_groups_Panel_1.size = New-Object System.Drawing.Size(700,420)
$Tab2_groups_Panel_1.Dock = "Fill" 
$Tab2_groups_Panel_1.ColumnCount = 0
$Tab2_groups_Panel_1.RowCount = 0
$Tab2_groups_Panel_1.BorderStyle = "None"
$Tab2_groups_Panel_1.AutoSize = $true
$Tab2_groups_Panel_1.AutoScroll = $true
$Tab2_groups_Panel_1.Multiline = $true
$Tab2_groups_Panel_1.ScrollBars = "vertical"
#$Tab1_mailboxes_Panel_1.BackColor = "Pink"
$Tab2_groups.controls.add($Tab2_groups_Panel_1)


# Mailbox image
$Group_iconBase64 = "
/9j/4AAQSkZJRgABAQEAYABgAAD/4QBwRXhpZgAATU0AKgAAAAgABgExAAIAAAAKAAAAVgMBAAUAAAABAAAAYAMDAAEAAAABAAAAAFEQAAEAAAABAQAAAFERAAQAAAABA
AAOw1ESAAQAAAABAAAOwwAAAABHcmVlbnNob3QAAAGGoAAAsY//2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICA
gMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCABkAGQDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/
8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh
4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDB
AcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXm
JmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9+o/9Wv0p1Nj/ANWv0p1ABRRRQAUUUZoAKKM0ZoAKKKKACiiigCvdf6z8K
KLr/WfhRQBNH/q1+lOpsf8Aq1+lOoAKKKKAMnxv450f4beFrzWte1G00nStPjMtxdXMgjjiUdyTXwH+0F/wcGeEfBXiWbTfh/4VuvGUNuSp1K6uTYWsrD/nmCjOy+5C57ZHNeIf8F4P2ur/AMefGmH4X
abcTQ6F4XRZtRRGKreXTgEBh3VFxgHuTX5/9K/obgHwpwWJwMMyzhOTqK8YXaSi9m2rNt7pJpJb3P558QPFbG4XHTy3J2o+zdpTaTfMt0k7pJbap3e3n+onw4/4OLY7jW1j8XfDhrbT3KgzaXqHmyRc8
ko6gNgdgRX3/wDs+ftM+Cf2o/BMOv8AgvXLXVrN1Hmxg7bi0Y/wSx/eRh6H8K/m9r1r9ir9q/WP2Ofj1pPirTp7j+zPOSLWLJHIS+tScOCOhZRllPqPrXscU+D2XVsNKrk6dOrFXUbtxl5e82030d7X3
XVeLwp4xZjSxUaOcNVKUnZyslKN+vupJpdVa9tmf0TUVU0HW7fxJolnqFnIs1rfQpPC46OjAEH8jVuv5hd07M/p9NNXQUUUUDK91/rPwoouv9Z+FFAEvmLFBuZlVVXJJOABX5yftff8HM3wP/Zx8cXnh
vwnpuvfFbU9NmaC8utFeKDS4ZFOGRbmQ4lIOQTErLkfeq7/AMHKn7Wutfs3/sBW/h7w7e3Gm6t8UtVXw9LdQMUkhsRDJNdBWHILogiyOdsrY5r+dBEWNFVQFVRgKBgAUAf0Nfsnf8HO3wP+PnjW18P+M
tJ8QfCm81CVYbW+1eSK50tnbgLJcRH9zk4G6RFT1YV+kcFxHdQRyxSJJHIodHU7lcHkEHuDX8YTBWVgRuVgQQe9f0N/8GxX7WWtfH/9h7VvB3iC6uNQvPhTqq6RZXU775H06WIS28ZJ5PlfvIxn+BEHa
gD4i/4KlaHdaF+358TEu9xa41Q3ERPeN1BX9K8Br9Xv+C4f/BPvUviNFH8XvB9i97qGl23k+ILSLmSa3QfJOi9ygyGA5xg9q/J8Nur+1eAc8w+ZZJQlRfvQjGEl1TiktfJ2uvJn8U+IOR4jLc7rxrJ8s
5OcX0ak7791ez8x1NbhG9KdmvYP2JP2NfEn7a3xlsvDuj2si6RbSJNrepEYhsLbPzZb++wBVVHJPPQEj6nHY6hgsPPFYmSjCCu2+3+fZdXoj5TL8BXxuJhhcNFynNpJL+vvfRH7ff8ABPy7nvv2JPhZJ
ctunbw1YhzyTkQr1zzn1969izWX4M8J2fgTwppui6bDHb2Gl26WsEaKFVERQoAA9hXlP7UXxuvfClzH4f0edra6liEt3cJ/rIlOdqKexOCSeoGMda/gvHYhV8TUrxVlKTdu13c/vfA4d0MNToSd3GKV+
9kke07xuxkZ9KWvhUaveC8+0fbLsXAO7zfObzM+u7Oa+hP2XvjbeeMnn0LWJjcXlvF51tcN9+ZAQGVvVhkHPUg89MnlOo9euv8AWfhRRdf6z8KKAPz9/wCDkb9kDWv2nf2A4tc8NWNxqWufC/VF8RGzg
UvLcWXlSQ3WxQMsyRuJcDkiEgZJFfzkpIsqKysrIwyCDwR2r+z5BuiGeQRjFfnR+2z/AMG5X7Pfx+8V33izTdU1T4P6pqUzT3p0eWBdLuJGJLP9mmUpGxOSfKKAkkkZ5oA/nYdxGpJIVVGSSeBX9EH/A
AbJ/sj61+zx+w7qfi7xFaXGnaj8VtUXWbS0nTZJFp8UQitnZTyPM/eSgH+CRPWo/wBjL/g25/Z5+C/iqz8T6zrWrfGK806ZZrWLVZoP7KideVZreABZSDg4lZ14+7X6LazrNj4Q0G4vr64t9P07T4TLN
NKwjigjUZJJ6AACmk27ITkkrstTwJdQtHIqyRyAqysMhgexr46/aw/4Jjfs7/EfWptU1q5sfA+sahJ57z2l9HarMcEE+Wx28nk4xzXyp+3z/wAFvfEXjXxHqHhn4R3X9jeHYd9vJrRjBudQ7Fos/wCrT
rg9T14r4F8R+MtZ8Y3v2jV9X1PVJ+f3l3dPMw5zj5iePYV+78F+F+eU0sdPEvCuS2jdzt/eV0l6O77pM/CeNPFHI5N4GOGWKUXvKygn/ddm36q3k2fql8Ov+CP37NNvr6m4+I03iNZPlS1Or26ZYkY5T
k+mPevuz4K/A7wh8AfBcOh+DdF0/RdLjwdlsgBlbH3nbqze5NfzYxXEkDho5JY2HQq5Uj8q+gv2Xf8Agp78Wv2W9aD2fiC68SaNI6G50zWJWuUkUdkdiWjOMjIOPY4r3eKvDPPMfRvHMHWtryT91N+Vm
1f1S9TwuFfE7IsDWtLAKhzbyh7zXrdJ29H8j9/K+Xf2ufD1xpnxT+3SK32bU7dDE+ONyDay59Rwf+BV6B+xl+2j4S/bW+FsXiDw3ceTe2+2PU9MlYC406XH3WHdTzhhwRXpfjXwPpfj/RXsNWtVuLdju
BztaJuzK3UH3r+c8Zg6+Eryw2Ji4zi7NPdM/ovB4yhi6McRhpKUJK6a2aPiKvVv2QvDtxqXxOk1BVYW2m2ziR8cFn4Vfr1P4V1Y/ZR8JjWNh8TXHl7v+PbzofM+mcZ/SvXfBngrTPAWhx6fpVstvbKdx
wdzSN3Zj1JPrXMdJeuv9Z+FFF1/rPwooA/Pv/gt9/wWf/4d4eHLHwN4Bj0/Uvi14ktPtSPcp51t4ctCSq3MqfxyOysI4zgHYzNlVCt/P18bvj746/aW8WT678QvF/iDxlqlw25ptVvXnWP2jjz5ca+io
qqPSvqn/goj+yN+0l+1D+3P8VPHMnwV+Ld/a6x4huYtOmTwtfSRmxt2+z2uxhHgp5MSEEcHcT3rxof8EyP2jB/zQn4vf+Elff8AxqgD7T/4NVv2cbzx3+1r4w+ILXWoWug/D3SVtUtre5eG3vL+9LKnm
RqQsgjhimOGBAaRG6gV9k/8F9/2wJtD0rSfhBol1JDJqUY1PXmjbG6DJEMBPozBmI9FX1rZ/wCDaP8AZd8Ufs1fsYeLv+E28J6/4P8AEviLxhPcSWesafLY3TW8VrbRxPskVW2EiTBxg818N/8ABRuDx
Z8S/wBuD4kapc6DrDbdWa0iMdpIyGKFViQqcYwVUHjuTX6l4R5Th8Xnft8Tblox5le2srpR37Xv6pH5f4t5tiMJkbo4VPmrSUXa+kbNvbva3o2fPQHFLWx/wrvxF/0L2uf+AMn+FJ/wrzxF/wBC/rf/A
IAyf4V/WH1qj/OvvR/Jf1PEfyP7mZFFbH/Cu/EX/QA1r/wBk/wpv/Cv/EX/AEL+t/8AgFJ/hR9ao/zr70H1PEfyP7meifsSftU6p+x7+0Pofi6ymuP7NWZbfWbVGO29s2IEgK92UHcvoyj3r9u/2ndYk
8V/CXRde0XUppNHvGSRvs8mI7mKVNyOcdRx9Pmr8AG+HniBhj+wNc54/wCPGT/Cv2s/4J5ajq3xd/4Jb6BZ6pZXS6lpdnLpsULQMkzC2kxF8p5JKqvPfNfgfjblOHlSoZrRa578krNappuP3Wa+a7H79
4I5riYTrZVWT5Lc8bp6O6UkvW6fy8ziRGv91fyruPhV8eda+Gd/EvnzX+k5AltJXLBV7mMn7rD8j39ayf8AhU3ir/oXNc/8ApP8KP8AhUvik/8AMt65/wCAUn+Ffzyf0MfX2ka9a+KNItdQspBNa3kQk
jcdwf6joR60V5L8A9Q8QeC/A76fe6HqqmG6doVltnUqjBTwCOm4t+tFAHtkf+rX6U6mx/6tfpTqACq76XbSuWa3hZm6kxgk1YooAr/2Raf8+tv/AN+h/hR/ZFp/z62//fof4VYooArf2NZ/8+tt/wB+l
/wo/saz/wCfW2/79L/hVmigCt/Y1n/z623/AH6X/CpYLaO1j2xxpGvoi7R+lSUUAFFFFAFe6/1n4UUXX+s/CigCwo2rj0ooooAKKKKACiiigAooooAKKKKACiiigBkkAlbJLfhRRRQB/9k=
"
$Group_iconBytes = [Convert]::FromBase64String($Group_iconBase64)
# initialize a Memory stream holding the bytes
#$Maibox_stream = [System.IO.MemoryStream]::new($Mailbox_iconBytes, 0, $Mailbox_iconBytes.Length)
#$Tab1_mailboxes_Panel_1.Icon  = [System.Drawing.Icon]::FromHandle(([System.Drawing.Bitmap]::new($Maibox_stream).GetHIcon()))

$Group_PictureBox = new-object Windows.Forms.PictureBox
$Group_PictureBox.Location = New-Object System.Drawing.Size(569,30)
$Group_PictureBox.Size = New-Object System.Drawing.Size(100,100)
$Group_PictureBox.Image = $Group_iconBytes
$Tab2_groups_Panel_1.controls.add($Group_PictureBox)

# inside Panel
$Group_Alias = New-Object System.Windows.Forms.Label
$Group_Alias.Location = New-Object System.Drawing.Point(15,10)
$Group_Alias.AutoSize = $true
$Group_Alias.TabIndex = 1
$Group_Alias.Text = "Alias:"
$Group_Alias.ForeColor = "Black"
$Tab2_groups_Panel_1.Controls.Add($Group_Alias)

$Group_AliasTextBox = New-Object System.Windows.Forms.TextBox
$Group_AliasTextBox.Location = New-Object System.Drawing.Point(15,35)
$Group_AliasTextBox.Size = New-Object System.Drawing.Size(500,30)
$Group_AliasTextBox.TabIndex = 1
$Group_AliasTextBox.Text = "HR."
$Group_AliasTextBox.ForeColor = "Blue"
$Tab2_groups_Panel_1.Controls.Add($Group_AliasTextBox)

$Group_ExistingCheckbox = New-Object System.Windows.Forms.Checkbox 
$Group_ExistingCheckbox.Location = New-Object System.Drawing.Point(15,70)
$Group_ExistingCheckbox.AutoSize = $true
$Group_ExistingCheckbox.TabIndex = 1
$Group_ExistingCheckbox.Text = "Mail enable existing AD group"
$Group_ExistingCheckbox.ForeColor = "Black"
$Group_ExistingCheckbox.add_CheckedChanged({Group_ExistingGroupCheckBox_function})
$Tab2_groups_Panel_1.Controls.Add($Group_ExistingCheckbox)

$Group_ExistingCheckboxInfo = New-Object System.Windows.Forms.Label
$Group_ExistingCheckboxInfo.Location = New-Object System.Drawing.Point(540,150)
$Group_ExistingCheckboxInfo.Size = New-Object System.Drawing.Size(160,300)
$Group_ExistingCheckboxInfo.TabIndex = 1
$Group_ExistingCheckboxInfo.Text = "Use this option to mail-enable existing universal security groups and universal distribution groups that aren't already mail-enabled."
$Group_ExistingCheckboxInfo.ForeColor = "Gray"

$Group_ExistingGroupLabel = New-Object System.Windows.Forms.Label
$Group_ExistingGroupLabel.Location = New-Object System.Drawing.Point(15,100)
$Group_ExistingGroupLabel.Size = New-Object System.Drawing.Size(250,20)
$Group_ExistingGroupLabel.TabIndex = 1
$Group_ExistingGroupLabel.Text = "Group name:"
$Group_ExistingGroupLabel.ForeColor = "Black"

$Group_ExistingGroupTextBox = New-Object System.Windows.Forms.TextBox
$Group_ExistingGroupTextBox.Location = New-Object System.Drawing.Point(15,120)
$Group_ExistingGroupTextBox.Size = New-Object System.Drawing.Size(300,30)
$Group_ExistingGroupTextBox.TabIndex = 1
$Group_ExistingGroupTextBox.ForeColor = "Blue"

$Group_ExistingGroupCheckButton = New-Object System.Windows.Forms.Button
$Group_ExistingGroupCheckButton.Location = New-Object System.Drawing.Point(355,120)
$Group_ExistingGroupCheckButton.Size = New-Object System.Drawing.Size(160,23)
$Group_ExistingGroupCheckButton.TabIndex = 1
$Group_ExistingGroupCheckButton.Text = "Get-ADGroup"
$Group_ExistingGroupCheckButton.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Group_ExistingGroupCheckButton.Add_Click({Group_ExistingGroupCheck_AD_function})



function Group_ExistingGroupCheck_AD_function(){
    try {
        if ($Group_ExistingGroupTextBox.Text){
            $Group_Existing_ADgroup = Get-ADGroup ($Group_ExistingGroupTextBox.Text); 
            $Logs.AppendText("$(Datum_Function) - OK - $Group_Existing_ADgroup.DistinguishedName`r`n")
            $Logs.ScrollToCaret()
            }
        }
    catch {
        Error_Function
    } 
}

$Group_ExistingPrimarySmtpAddressLabel = New-Object System.Windows.Forms.Label
$Group_ExistingPrimarySmtpAddressLabel.Location = New-Object System.Drawing.Point(15,145)
$Group_ExistingPrimarySmtpAddressLabel.Size = New-Object System.Drawing.Point(250,20)
$Group_ExistingPrimarySmtpAddressLabel.TabIndex = 1
$Group_ExistingPrimarySmtpAddressLabel.Text = "PrimarySmtpAddress:"
$Group_ExistingPrimarySmtpAddressLabel.ForeColor = "Black"

$Group_ExistingPrimarySmtpAddressTextBox= New-Object System.Windows.Forms.TextBox 
$Group_ExistingPrimarySmtpAddressTextBox.Location = New-Object System.Drawing.Point(15,165)
$Group_ExistingPrimarySmtpAddressTextBox.Size = New-Object System.Drawing.Size(500,30)
$Group_ExistingPrimarySmtpAddressTextBox.TabIndex = 1
$Group_ExistingPrimarySmtpAddressTextBox.ForeColor = "Blue"

$Group_ExistingAddMembersLabel = New-Object System.Windows.Forms.Label
$Group_ExistingAddMembersLabel.Location = New-Object System.Drawing.Point(15,190)
$Group_ExistingAddMembersLabel.Size = New-Object System.Drawing.Point(250,20)
$Group_ExistingAddMembersLabel.TabIndex = 1
$Group_ExistingAddMembersLabel.Text = "Add members:"
$Group_ExistingAddMembersLabel.ForeColor = "Black"

$Group_ExistingAddMembersTextBox= New-Object System.Windows.Forms.RichTextBox 
$Group_ExistingAddMembersTextBox.Location = New-Object System.Drawing.Point(15,210)
$Group_ExistingAddMembersTextBox.Size = New-Object System.Drawing.Size(300,60)
$Group_ExistingAddMembersTextBox.TabIndex = 1
$Group_ExistingAddMembersTextBox.ForeColor = "Blue"

$Group_ExistingGroupCheckNamesButton = New-Object System.Windows.Forms.Button
$Group_ExistingGroupCheckNamesButton.Location = New-Object System.Drawing.Point(355,210)
$Group_ExistingGroupCheckNamesButton.Size = New-Object System.Drawing.Size(160,23)
$Group_ExistingGroupCheckNamesButton.TabIndex = 1
$Group_ExistingGroupCheckNamesButton.Text = "Check names"
$Group_ExistingGroupCheckNamesButton.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Group_ExistingGroupCheckNamesButton.Add_Click({Get-ADUser_CheckNames_function})

function Get-ADUser_CheckNames_function(){
    try {
        $CheckNames_UserInput = ($Group_ExistingAddMembersTextBox.Text) #provjeri kakav input ce bit 
        $Names = foreach ($CheckName in $CheckNames_UserInput){
            get-aduser $CheckName
        }
    }
    catch {
        Error_Function
    } 
}

$Group_NewGroupCheckbox = New-Object System.Windows.Forms.Checkbox 
$Group_NewGroupCheckbox.Location = New-Object System.Drawing.Point(350,70)
$Group_NewGroupCheckbox.AutoSize = $true
$Group_NewGroupCheckbox.TabIndex = 1
$Group_NewGroupCheckbox.Text = "New group"
$Group_NewGroupCheckbox.ForeColor = "Black"
$Group_NewGroupCheckbox.add_CheckedChanged({Group_NewGroupCheckbox_function})
$Tab2_groups_Panel_1.Controls.Add($Group_NewGroupCheckbox)

$Group_NewGroupCheckboxInfo = New-Object System.Windows.Forms.Label
$Group_NewGroupCheckboxInfo.Location = New-Object System.Drawing.Point(540,150)
$Group_NewGroupCheckboxInfo.Size = New-Object System.Drawing.Size(160,300)
$Group_NewGroupCheckboxInfo.TabIndex = 1
$Group_NewGroupCheckboxInfo.Text = "Use this option to create distribution groups, mail-enabled security groups or room lists."
$Group_NewGroupCheckboxInfo.ForeColor = "Gray"

function Group_ExistingGroupCheckBox_function(){
    if ($Group_ExistingCheckbox.checked -eq $true){
        $Group_NewGroupCheckbox.Enabled = $false
        $Tab2_groups_Panel_1.Controls.Add($Group_ExistingCheckboxInfo)
        $Tab2_groups_Panel_1.Controls.Add($Group_ExistingGroupLabel)
        $Tab2_groups_Panel_1.Controls.Add($Group_ExistingGroupTextBox)
        $Tab2_groups_Panel_1.Controls.Add($Group_ExistingGroupCheckButton)
        $Tab2_groups_Panel_1.Controls.Add($Group_ExistingPrimarySmtpAddressLabel)
        $Tab2_groups_Panel_1.Controls.Add($Group_ExistingPrimarySmtpAddressTextBox)
        $Tab2_groups_Panel_1.Controls.Add($Group_ExistingAddMembersLabel)
        $Tab2_groups_Panel_1.Controls.Add($Group_ExistingAddMembersTextBox)
        $Tab2_groups_Panel_1.Controls.Add($Group_ExistingGroupCheckNamesButton)
        
        $Tab2_groups_Panel_1.Controls.Add($Create_Group_Button_Existing) 
        }
    else {
        $Group_NewGroupCheckbox.Enabled = $true
        $Tab2_groups_Panel_1.Controls.Remove($Group_ExistingCheckboxInfo)
        $Tab2_groups_Panel_1.Controls.Remove($Group_ExistingGroupLabel)
        $Tab2_groups_Panel_1.Controls.Remove($Group_ExistingGroupTextBox)
        $Tab2_groups_Panel_1.Controls.Remove($Group_ExistingGroupCheckButton)
        $Tab2_groups_Panel_1.Controls.Remove($Group_ExistingPrimarySmtpAddressLabel)
        $Tab2_groups_Panel_1.Controls.Remove($Group_ExistingPrimarySmtpAddressTextBox)
        $Tab2_groups_Panel_1.Controls.Remove($Group_ExistingAddMembersLabel)
        $Tab2_groups_Panel_1.Controls.Remove($Group_ExistingAddMembersTextBox)
        $Tab2_groups_Panel_1.Controls.Remove($Group_ExistingGroupCheckNamesButton)

        $Tab2_groups_Panel_1.Controls.Remove($Create_Group_Button_Existing) 
    }
}

$Group_DisplayNameNameLabel = New-Object System.Windows.Forms.Label
$Group_DisplayNameNameLabel.Location = New-Object System.Drawing.Point(15,100)
$Group_DisplayNameNameLabel.Size = New-Object System.Drawing.Size(250,20)
$Group_DisplayNameNameLabel.TabIndex = 1
$Group_DisplayNameNameLabel.Text = "Display name:"
$Group_DisplayNameNameLabel.ForeColor = "Black"

$Group_DisplayNameTextBox= New-Object System.Windows.Forms.TextBox 
$Group_DisplayNameTextBox.Location = New-Object System.Drawing.Point(15,120)
$Group_DisplayNameTextBox.Size = New-Object System.Drawing.Size(500,30)
$Group_DisplayNameTextBox.TabIndex = 1
$Group_DisplayNameTextBox.ForeColor = "Blue"

$Group_OwnerNameLabel= New-Object System.Windows.Forms.Label
$Group_OwnerNameLabel.Location = New-Object System.Drawing.Point(15,145)
$Group_OwnerNameLabel.Size = New-Object System.Drawing.Size(250,20)
$Group_OwnerNameLabel.TabIndex = 1
$Group_OwnerNameLabel.Text = "Owner:"
$Group_OwnerNameLabel.ForeColor = "Black"

$Group_OwnerNameTextBox= New-Object System.Windows.Forms.TextBox 
$Group_OwnerNameTextBox.Location = New-Object System.Drawing.Point(15,165)
$Group_OwnerNameTextBox.Size = New-Object System.Drawing.Size(300,30)
$Group_OwnerNameTextBox.TabIndex = 1
$Group_OwnerNameTextBox.ForeColor = "Blue"

$Group_GetOwnerButton = New-Object System.Windows.Forms.Button
$Group_GetOwnerButton.Location = New-Object System.Drawing.Point(350,165)
$Group_GetOwnerButton.Size = New-Object System.Drawing.Size(165,23)
$Group_GetOwnerButton.TabIndex = 1
$Group_GetOwnerButton.Text = "Get-ADUser"
$Group_GetOwnerButton.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Group_GetOwnerButton.Add_Click({Get-ADUser_function})

$Group_DescriptionLabel = New-Object System.Windows.Forms.Label
$Group_DescriptionLabel.Location = New-Object System.Drawing.Point(15,190)
$Group_DescriptionLabel.Size = New-Object System.Drawing.Point(250,20)
$Group_DescriptionLabel.TabIndex = 1
$Group_DescriptionLabel.Text = "Description:"
$Group_DescriptionLabel.ForeColor = "Black"

$Group_DescriptionTextBox= New-Object System.Windows.Forms.TextBox 
$Group_DescriptionTextBox.Location = New-Object System.Drawing.Point(15,210)
$Group_DescriptionTextBox.Size = New-Object System.Drawing.Size(500,30)
$Group_DescriptionTextBox.TabIndex = 1
$Group_DescriptionTextBox.ForeColor = "Blue"

$Group_OrganizationalUnitLabel = New-Object System.Windows.Forms.Label
$Group_OrganizationalUnitLabel.Location = New-Object System.Drawing.Point(15,235)
$Group_OrganizationalUnitLabel.Size = New-Object System.Drawing.Point(250,20)
$Group_OrganizationalUnitLabel.TabIndex = 1
$Group_OrganizationalUnitLabel.Text = "Organizational unit:"
$Group_OrganizationalUnitLabel.ForeColor = "Black"

$Group_OrganizationalUnitDropMenu= New-Object System.Windows.Forms.ComboBox
$Group_OrganizationalUnitDropMenu.Location = New-Object System.Drawing.Point(15,255)
$Group_OrganizationalUnitDropMenu.Size = New-Object System.Drawing.Size(500,30)
$Group_OrganizationalUnitDropMenu.TabIndex = 1
$Group_OrganizationalUnitDropMenu.ForeColor = "Blue"
$Group_OrganizationalUnitDropMenu.Height = 80

[void] $Group_OrganizationalUnitDropMenu.Items.Add('atl-dc-001')
[void] $Group_OrganizationalUnitDropMenu.Items.Add('atl-dc-002')
[void] $Group_OrganizationalUnitDropMenu.Items.Add('atl-dc-003')
[void] $Group_OrganizationalUnitDropMenu.Items.Add('atl-dc-004')
[void] $Group_OrganizationalUnitDropMenu.Items.Add('atl-dc-005')
[void] $Group_OrganizationalUnitDropMenu.Items.Add('atl-dc-006')
[void] $Group_OrganizationalUnitDropMenu.Items.Add('atl-dc-007')

$Group_PrimarySmtpAddressLabel_New = New-Object System.Windows.Forms.Label
$Group_PrimarySmtpAddressLabel_New.Location = New-Object System.Drawing.Point(15,280)
$Group_PrimarySmtpAddressLabel_New.Size = New-Object System.Drawing.Point(250,20)
$Group_PrimarySmtpAddressLabel_New.TabIndex = 1
$Group_PrimarySmtpAddressLabel_New.Text = "PrimarySmtpAddress:"
$Group_PrimarySmtpAddressLabel_New.ForeColor = "Black"

$Group_PrimarySmtpAddressTextBox_New= New-Object System.Windows.Forms.TextBox 
$Group_PrimarySmtpAddressTextBox_New.Location = New-Object System.Drawing.Point(15,300)
$Group_PrimarySmtpAddressTextBox_New.Size = New-Object System.Drawing.Size(500,30)
$Group_PrimarySmtpAddressTextBox_New.TabIndex = 1
$Group_PrimarySmtpAddressTextBox_New.ForeColor = "Blue"

$Group_GroupTypeLabel = New-Object System.Windows.Forms.Label
$Group_GroupTypeLabel.Location = New-Object System.Drawing.Point(15,325)
$Group_GroupTypeLabel.Size = New-Object System.Drawing.Point(250,20)
$Group_GroupTypeLabel.TabIndex = 01
$Group_GroupTypeLabel.Text = "Group type:"
$Group_GroupTypeLabel.ForeColor = "Black"

$Group_GroupTypeDropMenu= New-Object System.Windows.Forms.ComboBox
$Group_GroupTypeDropMenu.Location = New-Object System.Drawing.Point(15,345)
$Group_GroupTypeDropMenu.Size = New-Object System.Drawing.Size(500,30)
$Group_GroupTypeDropMenu.TabIndex = 1
#$Group_GroupTypeDropMenu.SelectedIndex = 0
$Group_GroupTypeDropMenu.ForeColor = "Blue"
$Group_GroupTypeDropMenu.Height = 80

[void] $Group_GroupTypeDropMenu.Items.Add('Distribution')
[void] $Group_GroupTypeDropMenu.Items.Add('Security')
[void] $Group_GroupTypeDropMenu.Items.Add('Room list')

$Group_AddMembersLabel = New-Object System.Windows.Forms.Label
$Group_AddMembersLabel.Location = New-Object System.Drawing.Point(15,370)
$Group_AddMembersLabel.Size = New-Object System.Drawing.Point(250,20)
$Group_AddMembersLabel.TabIndex = 1
$Group_AddMembersLabel.Text = "Add members:"
$Group_AddMembersLabel.ForeColor = "Black"

$Group_AddMembersTextBox= New-Object System.Windows.Forms.RichTextBox 
$Group_AddMembersTextBox.Location = New-Object System.Drawing.Point(15,390)
$Group_AddMembersTextBox.Size = New-Object System.Drawing.Size(300,60)
$Group_AddMembersTextBox.TabIndex = 1
$Group_AddMembersTextBox.ForeColor = "Blue"

$Group_GroupCheckNamesButton = New-Object System.Windows.Forms.Button
$Group_GroupCheckNamesButton.Location = New-Object System.Drawing.Point(355,390)
$Group_GroupCheckNamesButton.Size = New-Object System.Drawing.Size(160,23)
$Group_GroupCheckNamesButton.TabIndex = 1
$Group_GroupCheckNamesButton.Text = "Check names"
$Group_GroupCheckNamesButton.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Group_GroupCheckNamesButton.Add_Click({Get-ADUser_CheckNames_function})


# Create group button - Existing
$Create_Group_Button_Existing = New-Object System.Windows.Forms.Button
$Create_Group_Button_Existing.Location = New-Object System.Drawing.Size(210,465)
$Create_Group_Button_Existing.Size = New-Object System.Drawing.Size(300,23)
$Create_Group_Button_Existing.Text = "Create group"
$Create_Group_Button_Existing.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Create_Group_Button_Existing.ForeColor = "Black"
$Create_Group_Button_Existing.TabIndex = 1
$Create_Group_Button_Existing.Enabled = $True
$Create_Group_Button_Existing.Add_Click({ Exchange_Connection; Create_ExistingGroup })

# Create group button - New
$Create_Group_Button_New = New-Object System.Windows.Forms.Button
$Create_Group_Button_New.Location = New-Object System.Drawing.Size(210,465)
$Create_Group_Button_New.Size = New-Object System.Drawing.Size(300,23)
$Create_Group_Button_New.Text = "Create group"
$Create_Group_Button_New.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Create_Group_Button_New.ForeColor = "Black"
$Create_Group_Button_New.TabIndex = 1
$Create_Group_Button_New.Enabled = $True
$Create_Group_Button_New.Add_Click({ Exchange_Connection; Create_NewGroup })

function Create_ExistingGroup() {
    
}

function Create_NewGroup() {
    
}

function Group_NewGroupCheckbox_function(){
    if ($Group_NewGroupCheckbox.checked -eq $true){
        $Group_ExistingCheckbox.Enabled = $false
        $Tab2_groups_Panel_1.Controls.Add($Group_NewGroupCheckboxInfo)
        $Tab2_groups_Panel_1.Controls.Add($Group_DisplayNameNameLabel)
        $Tab2_groups_Panel_1.Controls.Add($Group_DisplayNameTextBox)
        $Tab2_groups_Panel_1.Controls.Add($Group_OwnerNameLabel) 
        $Tab2_groups_Panel_1.Controls.Add($Group_OwnerNameTextBox) 
        $Tab2_groups_Panel_1.Controls.Add($Group_GetOwnerButton) 
        $Tab2_groups_Panel_1.Controls.Add($Group_DescriptionLabel) 
        $Tab2_groups_Panel_1.Controls.Add($Group_DescriptionTextBox) 
        $Tab2_groups_Panel_1.Controls.Add($Group_OrganizationalUnitLabel) 
        $Tab2_groups_Panel_1.Controls.Add($Group_OrganizationalUnitDropMenu) 
        $Tab2_groups_Panel_1.Controls.Add($Group_PrimarySmtpAddressLabel_New) 
        $Tab2_groups_Panel_1.Controls.Add($Group_PrimarySmtpAddressTextBox_New) 
        $Tab2_groups_Panel_1.Controls.Add($Group_GroupTypeLabel) 
        $Tab2_groups_Panel_1.Controls.Add($Group_GroupTypeDropMenu) 
        $Tab2_groups_Panel_1.Controls.Add($Group_AddMembersLabel) 
        $Tab2_groups_Panel_1.Controls.Add($Group_AddMembersTextBox) 
        $Tab2_groups_Panel_1.Controls.Add($Group_GroupCheckNamesButton) 

        $Tab2_groups_Panel_1.Controls.Add($Create_Group_Button_New) 
        }
    else {
        $Group_ExistingCheckbox.Enabled = $true
        $Tab2_groups_Panel_1.Controls.Remove($Group_NewGroupCheckboxInfo)
        $Tab2_groups_Panel_1.Controls.Remove($Group_DisplayNameNameLabel)
        $Tab2_groups_Panel_1.Controls.Remove($Group_DisplayNameTextBox)
        $Tab2_groups_Panel_1.Controls.Remove($Group_OwnerNameLabel) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_OwnerNameTextBox) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_GetOwnerButton) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_DescriptionLabel) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_DescriptionTextBox) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_OrganizationalUnitLabel) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_OrganizationalUnitDropMenu) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_PrimarySmtpAddressLabel_New) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_PrimarySmtpAddressTextBox_New) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_GroupTypeLabel) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_GroupTypeDropMenu) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_AddMembersLabel) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_AddMembersTextBox) 
        $Tab2_groups_Panel_1.Controls.Remove($Group_GroupCheckNamesButton) 

        $Tab2_groups_Panel_1.Controls.Remove($Create_Group_Button_New) 
    }
}


#>

#------------- TAB 3 - resources -----------------------------------------------------------------------------------------

<#
# Panel (for scoll bar to work)
$Tab3_resources_Panel_1 = New-Object System.Windows.Forms.Panel
$Tab3_resources_Panel_1.Location = New-Object System.Drawing.Point(15,20) 
$Tab3_resources_Panel_1.size = New-Object System.Drawing.Size(700,420)
$Tab3_resources_Panel_1.Dock = "Fill" 
$Tab3_resources_Panel_1.ColumnCount = 0
$Tab3_resources_Panel_1.RowCount = 0
$Tab3_resources_Panel_1.BorderStyle = "None"
$Tab3_resources_Panel_1.AutoSize = $true
$Tab3_resources_Panel_1.AutoScroll = $true
$Tab3_resources_Panel_1.Multiline = $true
$Tab3_resources_Panel_1.ScrollBars = "vertical"
$Tab3_resources.controls.add($Tab3_resources_Panel_1)
#>
# Mailbox image
$Resource_iconBase64 = "
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
"
$Resource_iconBytes = [Convert]::FromBase64String($Resource_iconBase64)
# initialize a Memory stream holding the bytes
#$Maibox_stream = [System.IO.MemoryStream]::new($Mailbox_iconBytes, 0, $Mailbox_iconBytes.Length)
#$Tab1_mailboxes_Panel_1.Icon  = [System.Drawing.Icon]::FromHandle(([System.Drawing.Bitmap]::new($Maibox_stream).GetHIcon()))

$Resource_PictureBox = new-object Windows.Forms.PictureBox
$Resource_PictureBox.Location = New-Object System.Drawing.Size(569,30)
$Resource_PictureBox.Size = New-Object System.Drawing.Size(100,100)
$Resource_PictureBox.Image = $Resource_iconBytes
$Tab3_resources.controls.add($Resource_PictureBox)

# inside Panel
$Resource_Notification = New-Object System.Windows.Forms.Label
$Resource_Notification.Location = New-Object System.Drawing.Point(15,70)
$Resource_Notification.AutoSize = $true
$Resource_Notification.TabIndex = 0
$Resource_Notification.Text = "To create room mailbox go to mailbox tab and select mailbox type: Room"
$Resource_Notification.Enabled = $true
$Resource_Notification.ForeColor = "Gray"
$Tab3_resources.Controls.Add($Resource_Notification)


#------------- TAB 4 - contacts ------------------------------------------------------------------------------------------

# Panel (for scoll bar to work)
$Tab4_contacts_Panel_1 = New-Object System.Windows.Forms.Panel
$Tab4_contacts_Panel_1.Location = New-Object System.Drawing.Point(15,20) 
$Tab4_contacts_Panel_1.size = New-Object System.Drawing.Size(700,420)
$Tab4_contacts_Panel_1.Dock = "Fill" 
$Tab4_contacts_Panel_1.ColumnCount = 0
$Tab4_contacts_Panel_1.RowCount = 0
$Tab4_contacts_Panel_1.BorderStyle = "None"
$Tab4_contacts_Panel_1.AutoSize = $true
$Tab4_contacts_Panel_1.AutoScroll = $true
$Tab4_contacts_Panel_1.Multiline = $true
$Tab4_contacts_Panel_1.ScrollBars = "vertical"
$Tab4_contacts.controls.add($Tab4_contacts_Panel_1)


# Contact image
$Contacts_iconBase64 = "
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
"
$Contacts_iconBytes = [Convert]::FromBase64String($Contacts_iconBase64)
# initialize a Memory stream holding the bytes
#$Maibox_stream = [System.IO.MemoryStream]::new($Mailbox_iconBytes, 0, $Mailbox_iconBytes.Length)
#$Tab1_mailboxes_Panel_1.Icon  = [System.Drawing.Icon]::FromHandle(([System.Drawing.Bitmap]::new($Maibox_stream).GetHIcon()))

$Contacts_PictureBox = new-object Windows.Forms.PictureBox
$Contacts_PictureBox.Location = New-Object System.Drawing.Size(569,30)
$Contacts_PictureBox.Size = New-Object System.Drawing.Size(100,100)
$Contacts_PictureBox.Image = $Contacts_iconBytes
$Tab4_contacts_Panel_1.controls.add($Contacts_PictureBox)

# inside Panel

$Contact_alias = New-Object System.Windows.Forms.Label
$Contact_alias.Location = New-Object System.Drawing.Point(15,10)
$Contact_alias.AutoSize = $true
$Contact_alias.TabIndex = 0
$Contact_alias.Text = "Alias:"
$Contact_alias.ForeColor = "Black"
$Tab4_contacts_Panel_1.Controls.Add($Contact_alias)

$Contact_aliastextbox = New-Object System.Windows.Forms.TextBox
$Contact_aliastextbox.Location = New-Object System.Drawing.Point(15,35)
$Contact_aliastextbox.Size = New-Object System.Drawing.Size(500,30)
$Contact_aliastextbox.TabIndex = 0
$Contact_aliastextbox.Text = "HR."
$Contact_aliastextbox.ForeColor = "Blue"
$Tab4_contacts_Panel_1.Controls.Add($Contact_aliastextbox)

$Contact_NewMailContactCheckBox = New-Object System.Windows.Forms.Checkbox 
$Contact_NewMailContactCheckBox.Location = New-Object System.Drawing.Point(15,70)
$Contact_NewMailContactCheckBox.AutoSize = $true
$Contact_NewMailContactCheckBox.TabIndex = 0
$Contact_NewMailContactCheckBox.Text = "New mail contact"
$Contact_NewMailContactCheckBox.ForeColor = "Black"
$Contact_NewMailContactCheckBox.add_CheckedChanged({Contact_NewMailContactCheckbox_function})
$Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailContactCheckBox)

$Contact_NewMailContactCheckBoxInfo = New-Object System.Windows.Forms.Label
$Contact_NewMailContactCheckBoxInfo.Location = New-Object System.Drawing.Point(540,150)
$Contact_NewMailContactCheckBoxInfo.Size = New-Object System.Drawing.Size(160,300)
$Contact_NewMailContactCheckBoxInfo.TabIndex = 0
$Contact_NewMailContactCheckBoxInfo.Text = "Use this option to create mail contacts."
$Contact_NewMailContactCheckBoxInfo.ForeColor = "Gray"

$Contact_MailUserCheckbox = New-Object System.Windows.Forms.Checkbox 
$Contact_MailUserCheckbox.Location = New-Object System.Drawing.Point(350,70)
$Contact_MailUserCheckbox.AutoSize = $true
$Contact_MailUserCheckbox.TabIndex = 0
$Contact_MailUserCheckbox.Text = "Mail user"
$Contact_MailUserCheckbox.ForeColor = "Black"
$Contact_MailUserCheckbox.add_CheckedChanged({Contact_MailUserCheckbox_function})
$Tab4_contacts_Panel_1.Controls.Add($Contact_MailUserCheckbox)

$Contact_FirstNameLabel = New-Object System.Windows.Forms.Label
$Contact_FirstNameLabel.Location = New-Object System.Drawing.Point(15,100)
$Contact_FirstNameLabel.Size = New-Object System.Drawing.Size(250,20)
$Contact_FirstNameLabel.TabIndex = 0
$Contact_FirstNameLabel.Text = "First name:"
$Contact_FirstNameLabel.ForeColor = "Black"

$Contact_FirstNameTextBox= New-Object System.Windows.Forms.TextBox 
$Contact_FirstNameTextBox.Location = New-Object System.Drawing.Point(15,120)
$Contact_FirstNameTextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_FirstNameTextBox.TabIndex = 0
$Contact_FirstNameTextBox.ForeColor = "Blue"
$Contact_FirstNameTextBox.Add_Validating({
    $Contact_DisplayNameTextBox.Text = $Contact_FirstNameTextBox.Text + " " + $Contact_LastNameTextBox.Text
})

$Contact_LastNameLabel = New-Object System.Windows.Forms.Label
$Contact_LastNameLabel.Location = New-Object System.Drawing.Point(15,145)
$Contact_LastNameLabel.Size = New-Object System.Drawing.Size(250,20)
$Contact_LastNameLabel.TabIndex = 0
$Contact_LastNameLabel.Text = "Last name:"
$Contact_LastNameLabel.ForeColor = "Black"

$Contact_LastNameTextBox= New-Object System.Windows.Forms.TextBox 
$Contact_LastNameTextBox.Location = New-Object System.Drawing.Point(15,165)
$Contact_LastNameTextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_LastNameTextBox.TabIndex = 0
$Contact_LastNameTextBox.ForeColor = "Blue"
$Contact_LastNameTextBox.Add_Validating({
    $Contact_DisplayNameTextBox.Text = $Contact_FirstNameTextBox.Text + " " + $Contact_LastNameTextBox.Text
})

$Contact_DisplayNameLabel = New-Object System.Windows.Forms.Label
$Contact_DisplayNameLabel.Location = New-Object System.Drawing.Point(15,190)
$Contact_DisplayNameLabel.Size = New-Object System.Drawing.Point(250,20)
$Contact_DisplayNameLabel.TabIndex = 0
$Contact_DisplayNameLabel.Text = "Display name:"
$Contact_DisplayNameLabel.ForeColor = "Black"

$Contact_DisplayNameTextBox= New-Object System.Windows.Forms.TextBox 
$Contact_DisplayNameTextBox.Location = New-Object System.Drawing.Point(15,210)
$Contact_DisplayNameTextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_DisplayNameTextBox.TabIndex = 0
$Contact_DisplayNameTextBox.ForeColor = "Blue"

$Contact_OrganizationalUnitLabel = New-Object System.Windows.Forms.Label
$Contact_OrganizationalUnitLabel.Location = New-Object System.Drawing.Point(15,235)
$Contact_OrganizationalUnitLabel.Size = New-Object System.Drawing.Point(250,20)
$Contact_OrganizationalUnitLabel.TabIndex = 0
$Contact_OrganizationalUnitLabel.Text = "Organizational unit:"
$Contact_OrganizationalUnitLabel.ForeColor = "Black"

$Contact_OrganizationalUnitDropMenu= New-Object System.Windows.Forms.ComboBox
$Contact_OrganizationalUnitDropMenu.Location = New-Object System.Drawing.Point(15,255)
$Contact_OrganizationalUnitDropMenu.Size = New-Object System.Drawing.Size(500,30)
$Contact_OrganizationalUnitDropMenu.TabIndex = 0
$Contact_OrganizationalUnitDropMenu.ForeColor = "Blue"
$Contact_OrganizationalUnitDropMenu.Height = 80

[void] $Contact_OrganizationalUnitDropMenu.Items.Add('atl-dc-001')
[void] $Contact_OrganizationalUnitDropMenu.Items.Add('atl-dc-002')

$Contact_ExternalAdressLabel = New-Object System.Windows.Forms.Label
$Contact_ExternalAdressLabel.Location = New-Object System.Drawing.Point(15,280)
$Contact_ExternalAdressLabel.Size = New-Object System.Drawing.Point(250,20)
$Contact_ExternalAdressLabel.TabIndex = 0
$Contact_ExternalAdressLabel.Text = "External email address:"
$Contact_ExternalAdressLabel.ForeColor = "Black"

$Contact_ExternalAdressTextBox = New-Object System.Windows.Forms.TextBox 
$Contact_ExternalAdressTextBox.Location = New-Object System.Drawing.Point(15,300)
$Contact_ExternalAdressTextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_ExternalAdressTextBox.TabIndex = 0
$Contact_ExternalAdressTextBox.ForeColor = "Blue"

# Create contact button - new mail contact
$Create_NewMailContact_Button = New-Object System.Windows.Forms.Button
$Create_NewMailContact_Button.Location = New-Object System.Drawing.Size(210,465)
$Create_NewMailContact_Button.Size = New-Object System.Drawing.Size(300,23)
$Create_NewMailContact_Button.Text = "Create contact"
$Create_NewMailContact_Button.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Create_NewMailContact_Button.ForeColor = "Black"
$Create_NewMailContact_Button.TabIndex = 0
$Create_NewMailContact_Button.Enabled = $True
$Create_NewMailContact_Button.Add_Click({ Exchange_Connection; Create_MailContact })

function Create_MailContact() {

}

function Contact_NewMailContactCheckbox_function(){
    if ($Contact_NewMailContactCheckBox.checked -eq $true){
        $Contact_MailUserCheckBox.Enabled = $false
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailContactCheckBoxInfo)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_FirstNameLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_FirstNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_LastNameLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_LastNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_DisplayNameLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_DisplayNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_OrganizationalUnitLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_OrganizationalUnitDropMenu)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_ExternalAdressLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_ExternalAdressTextBox)

        $Tab4_contacts_Panel_1.Controls.Add($Create_NewMailContact_Button) 
        }
    else {
        $Contact_MailUserCheckBox.Enabled = $true
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailContactCheckBoxInfo)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_FirstNameLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_FirstNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_LastNameLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_LastNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_DisplayNameLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_DisplayNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_OrganizationalUnitLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_OrganizationalUnitDropMenu)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_ExternalAdressLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_ExternalAdressTextBox)

        $Tab4_contacts_Panel_1.Controls.Remove($Create_NewMailContact_Button) 
    }
}


$Contact_NewMailUserCheckbox = New-Object System.Windows.Forms.Checkbox 
$Contact_NewMailUserCheckbox.Location = New-Object System.Drawing.Point(370,95)
$Contact_NewMailUserCheckbox.AutoSize = $true
$Contact_NewMailUserCheckbox.TabIndex = 0
$Contact_NewMailUserCheckbox.Text = "new"
$Contact_NewMailUserCheckbox.ForeColor = "Black"
$Contact_NewMailUserCheckbox.add_CheckedChanged({Contact_NewMailUserCheckbox_function})

$Contact_NewMailUserCheckboxInfo = New-Object System.Windows.Forms.Label
$Contact_NewMailUserCheckboxInfo.Location = New-Object System.Drawing.Point(540,150)
$Contact_NewMailUserCheckboxInfo.Size = New-Object System.Drawing.Size(160,300)
$Contact_NewMailUserCheckboxInfo.TabIndex = 0
$Contact_NewMailUserCheckboxInfo.Text = "Use this option to create mail users which have email addresses and accounts in the Exchange organization, but they don't have Exchange mailboxes. Email messages sent to mail users are delivered to the specified external email address.

'c' attribute is automatically filled with value 'HR'."
$Contact_NewMailUserCheckboxInfo.ForeColor = "Gray"

$Contact_ExistingMailUserCheckbox = New-Object System.Windows.Forms.Checkbox 
$Contact_ExistingMailUserCheckbox.Location = New-Object System.Drawing.Point(370,120)
$Contact_ExistingMailUserCheckbox.AutoSize = $true
$Contact_ExistingMailUserCheckbox.TabIndex = 0
$Contact_ExistingMailUserCheckbox.Text = "existing"
$Contact_ExistingMailUserCheckbox.ForeColor = "Black"
$Contact_ExistingMailUserCheckbox.add_CheckedChanged({Contact_ExistingMailUserCheckbox_function})

$Contact_ExistingMailUserCheckboxInfo = New-Object System.Windows.Forms.Label
$Contact_ExistingMailUserCheckboxInfo.Location = New-Object System.Drawing.Point(540,150)
$Contact_ExistingMailUserCheckboxInfo.Size = New-Object System.Drawing.Size(160,300)
$Contact_ExistingMailUserCheckboxInfo.TabIndex = 0
$Contact_ExistingMailUserCheckboxInfo.Text = "Use this option to mail-enable existing users that aren't already mail-enabled. Email messages sent to mail users are delivered to the specified external email address."
$Contact_ExistingMailUserCheckboxInfo.ForeColor = "Gray"


# MAIL USER
function Contact_MailUserCheckbox_function(){
    if ($Contact_MailUserCheckBox.checked -eq $true){
        $Contact_NewMailContactCheckBox.Enabled = $false
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUserCheckbox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_ExistingMailUserCheckbox)
        #$Tab4_contacts_Panel_1.Controls.Add($Create_NewMailContact_Button) 
        }
    else {
        $Contact_NewMailContactCheckBox.Enabled = $true
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUserCheckbox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_ExistingMailUserCheckbox)
       # $Tab4_contacts_Panel_1.Controls.Remove($Create_NewMailContact_Button) 
    }
}

# Create contact button - New mail user
$Create_NewMailUser_Button = New-Object System.Windows.Forms.Button
$Create_NewMailUser_Button.Location = New-Object System.Drawing.Size(210,650)
$Create_NewMailUser_Button.Size = New-Object System.Drawing.Size(300,23)
$Create_NewMailUser_Button.Text = "Create mail user"
$Create_NewMailUser_Button.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Create_NewMailUser_Button.ForeColor = "Black"
$Create_NewMailUser_Button.TabIndex = 0
$Create_NewMailUser_Button.Enabled = $True
$Create_NewMailUser_Button.Add_Click({ Exchange_Connection; Create_NewMailUser })
function Create_NewMailUser() {

}

# NEW MAIL USER

$Contact_NewMailUser_FirstNameLabel = New-Object System.Windows.Forms.Label
$Contact_NewMailUser_FirstNameLabel.Location = New-Object System.Drawing.Point(15,145)
$Contact_NewMailUser_FirstNameLabel.Size = New-Object System.Drawing.Size(250,20)
$Contact_NewMailUser_FirstNameLabel.TabIndex = 0
$Contact_NewMailUser_FirstNameLabel.Text = "First name:"
$Contact_NewMailUser_FirstNameLabel.ForeColor = "Black"

$Contact_NewMailUser_FirstNameTextBox= New-Object System.Windows.Forms.TextBox 
$Contact_NewMailUser_FirstNameTextBox.Location = New-Object System.Drawing.Point(15,165)
$Contact_NewMailUser_FirstNameTextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_NewMailUser_FirstNameTextBox.TabIndex = 0
$Contact_NewMailUser_FirstNameTextBox.ForeColor = "Blue"
$Contact_NewMailUser_FirstNameTextBox.Add_Validating({
    $Contact_NewMailUser_DisplayNameTextBox.Text = $Contact_NewMailUser_FirstNameTextBox.Text + " " + $Contact_NewMailUser_LastNameTextBox.Text
})

$Contact_NewMailUser_LastNameLabel = New-Object System.Windows.Forms.Label
$Contact_NewMailUser_LastNameLabel.Location = New-Object System.Drawing.Point(15,190)
$Contact_NewMailUser_LastNameLabel.Size = New-Object System.Drawing.Size(250,20)
$Contact_NewMailUser_LastNameLabel.TabIndex = 0
$Contact_NewMailUser_LastNameLabel.Text = "Last name:"
$Contact_NewMailUser_LastNameLabel.ForeColor = "Black"

$Contact_NewMailUser_LastNameTextBox= New-Object System.Windows.Forms.TextBox 
$Contact_NewMailUser_LastNameTextBox.Location = New-Object System.Drawing.Point(15,215)
$Contact_NewMailUser_LastNameTextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_NewMailUser_LastNameTextBox.TabIndex = 0
$Contact_NewMailUser_LastNameTextBox.ForeColor = "Blue"
$Contact_NewMailUser_LastNameTextBox.Add_Validating({
    $Contact_NewMailUser_DisplayNameTextBox.Text = $Contact_NewMailUser_FirstNameTextBox.Text + " " + $Contact_NewMailUser_LastNameTextBox.Text
})

$Contact_NewMailUser_DisplayNameLabel = New-Object System.Windows.Forms.Label
$Contact_NewMailUser_DisplayNameLabel.Location = New-Object System.Drawing.Point(15,240)
$Contact_NewMailUser_DisplayNameLabel.Size = New-Object System.Drawing.Point(250,20)
$Contact_NewMailUser_DisplayNameLabel.TabIndex = 0
$Contact_NewMailUser_DisplayNameLabel.Text = "Display name:"
$Contact_NewMailUser_DisplayNameLabel.ForeColor = "Black"

$Contact_NewMailUser_DisplayNameTextBox= New-Object System.Windows.Forms.TextBox 
$Contact_NewMailUser_DisplayNameTextBox.Location = New-Object System.Drawing.Point(15,260)
$Contact_NewMailUser_DisplayNameTextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_NewMailUser_DisplayNameTextBox.TabIndex = 0
$Contact_NewMailUser_DisplayNameTextBox.ForeColor = "Blue"

$Contact_NewMailUser_OrganizationalUnitLabel = New-Object System.Windows.Forms.Label
$Contact_NewMailUser_OrganizationalUnitLabel.Location = New-Object System.Drawing.Point(15,285)
$Contact_NewMailUser_OrganizationalUnitLabel.Size = New-Object System.Drawing.Point(250,20)
$Contact_NewMailUser_OrganizationalUnitLabel.TabIndex = 0
$Contact_NewMailUser_OrganizationalUnitLabel.Text = "Organizational unit:"
$Contact_NewMailUser_OrganizationalUnitLabel.ForeColor = "Black"

$Contact_NewMailUser_OrganizationalUnitDropMenu= New-Object System.Windows.Forms.ComboBox
$Contact_NewMailUser_OrganizationalUnitDropMenu.Location = New-Object System.Drawing.Point(15,305)
$Contact_NewMailUser_OrganizationalUnitDropMenu.Size = New-Object System.Drawing.Size(500,30)
$Contact_NewMailUser_OrganizationalUnitDropMenu.TabIndex = 0
$Contact_NewMailUser_OrganizationalUnitDropMenu.ForeColor = "Blue"
$Contact_NewMailUser_OrganizationalUnitDropMenu.Height = 80

[void] $Contact_NewMailUser_OrganizationalUnitDropMenu.Items.Add('atl-dc-001')
[void] $Contact_NewMailUser_OrganizationalUnitDropMenu.Items.Add('atl-dc-002')
[void] $Contact_NewMailUser_OrganizationalUnitDropMenu.Items.Add('atl-dc-003')
[void] $Contact_NewMailUser_OrganizationalUnitDropMenu.Items.Add('atl-dc-004')
[void] $Contact_NewMailUser_OrganizationalUnitDropMenu.Items.Add('atl-dc-005')
[void] $Contact_NewMailUser_OrganizationalUnitDropMenu.Items.Add('atl-dc-006')
[void] $Contact_NewMailUser_OrganizationalUnitDropMenu.Items.Add('atl-dc-007')

$Contact_NewMailUser_UPNLabel = New-Object System.Windows.Forms.Label
$Contact_NewMailUser_UPNLabel.Location = New-Object System.Drawing.Point(15,330)
$Contact_NewMailUser_UPNLabel.Size = New-Object System.Drawing.Point(250,20)
$Contact_NewMailUser_UPNLabel.TabIndex = 0
$Contact_NewMailUser_UPNLabel.Text = "User logon name:"
$Contact_NewMailUser_UPNLabel.ForeColor = "Black"

$Contact_NewMailUser_UPNTextBox= New-Object System.Windows.Forms.TextBox 
$Contact_NewMailUser_UPNTextBox.Location = New-Object System.Drawing.Point(15,350)
$Contact_NewMailUser_UPNTextBox.Size = New-Object System.Drawing.Size(300,30)
$Contact_NewMailUser_UPNTextBox.TabIndex = 0
$Contact_NewMailUser_UPNTextBox.ForeColor = "Blue"

$Contact_NewMailUser_UPNDomainTextBox= New-Object System.Windows.Forms.TextBox 
$Contact_NewMailUser_UPNDomainTextBox.Location = New-Object System.Drawing.Point(350,350)
$Contact_NewMailUser_UPNDomainTextBox.Size = New-Object System.Drawing.Size(165,25)
$Contact_NewMailUser_UPNDomainTextBox.TabIndex = 0
$Contact_NewMailUser_UPNDomainTextBox.enabled = $false
$Contact_NewMailUser_UPNDomainTextBox.Text = "@domain.com"
$Contact_NewMailUser_UPNDomainTextBox.ForeColor = "Blue"

$Contact_NewMailUser_DescriptionLabel = New-Object System.Windows.Forms.Label
$Contact_NewMailUser_DescriptionLabel.Location = New-Object System.Drawing.Point(15,375)
$Contact_NewMailUser_DescriptionLabel.Size = New-Object System.Drawing.Point(250,20)
$Contact_NewMailUser_DescriptionLabel.TabIndex = 0
$Contact_NewMailUser_DescriptionLabel.Text = "Description:"
$Contact_NewMailUser_DescriptionLabel.ForeColor = "Black"

$Contact_NewMailUser_DescriptionTextBox= New-Object System.Windows.Forms.TextBox 
$Contact_NewMailUser_DescriptionTextBox.Location = New-Object System.Drawing.Point(15,395)
$Contact_NewMailUser_DescriptionTextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_NewMailUser_DescriptionTextBox.TabIndex = 0
$Contact_NewMailUser_DescriptionTextBox.ForeColor = "Blue"

$Contact_NewMailUser_DepartmentLabel = New-Object System.Windows.Forms.Label
$Contact_NewMailUser_DepartmentLabel.Location = New-Object System.Drawing.Point(15,420)
$Contact_NewMailUser_DepartmentLabel.Size = New-Object System.Drawing.Point(250,20)
$Contact_NewMailUser_DepartmentLabel.TabIndex = 0
$Contact_NewMailUser_DepartmentLabel.Text = "Department:"
$Contact_NewMailUser_DepartmentLabel.ForeColor = "Black"

$Contact_NewMailUser_DepartmentTextBox= New-Object System.Windows.Forms.TextBox 
$Contact_NewMailUser_DepartmentTextBox.Location = New-Object System.Drawing.Point(15,440)
$Contact_NewMailUser_DepartmentTextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_NewMailUser_DepartmentTextBox.TabIndex = 0
$Contact_NewMailUser_DepartmentTextBox.ForeColor = "Blue"

$Contact_NewMailUser_ExternalAdressLabel = New-Object System.Windows.Forms.Label
$Contact_NewMailUser_ExternalAdressLabel.Location = New-Object System.Drawing.Point(15,465)
$Contact_NewMailUser_ExternalAdressLabel.Size = New-Object System.Drawing.Point(250,20)
$Contact_NewMailUser_ExternalAdressLabel.TabIndex = 0
$Contact_NewMailUser_ExternalAdressLabel.Text = "External email address:"
$Contact_NewMailUser_ExternalAdressLabel.ForeColor = "Black"

$Contact_NewMailUser_ExternalAdressTextBox = New-Object System.Windows.Forms.TextBox 
$Contact_NewMailUser_ExternalAdressTextBox.Location = New-Object System.Drawing.Point(15,485)
$Contact_NewMailUser_ExternalAdressTextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_NewMailUser_ExternalAdressTextBox.TabIndex = 0
$Contact_NewMailUser_ExternalAdressTextBox.ForeColor = "Blue"

$Contact_NewMailUser_Password1Label = New-Object System.Windows.Forms.Label
$Contact_NewMailUser_Password1Label.Location = New-Object System.Drawing.Point(15,510)
$Contact_NewMailUser_Password1Label.Size = New-Object System.Drawing.Point(250,20)
$Contact_NewMailUser_Password1Label.TabIndex = 0
$Contact_NewMailUser_Password1Label.Text = "New password:"
$Contact_NewMailUser_Password1Label.ForeColor = "Black"

$Contact_NewMailUser_Password1TextBox = New-Object System.Windows.Forms.MaskedTextBox
$Contact_NewMailUser_Password1TextBox.Location = New-Object System.Drawing.Point(15,530)
$Contact_NewMailUser_Password1TextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_NewMailUser_Password1TextBox.PasswordChar = '*'
$Contact_NewMailUser_Password1TextBox.TabIndex = 0
$Contact_NewMailUser_Password1TextBox.ForeColor = "Blue"
$Contact_NewMailUser_Password1TextBox.Height = 80

$Contact_NewMailUser_Password2Label = New-Object System.Windows.Forms.Label
$Contact_NewMailUser_Password2Label.Location = New-Object System.Drawing.Point(15,555)
$Contact_NewMailUser_Password2Label.Size = New-Object System.Drawing.Point(250,20)
$Contact_NewMailUser_Password2Label.TabIndex = 0
$Contact_NewMailUser_Password2Label.Text = "Confirm password:"
$Contact_NewMailUser_Password2Label.ForeColor = "Black"

$Contact_NewMailUser_Password2TextBox = New-Object System.Windows.Forms.MaskedTextBox
$Contact_NewMailUser_Password2TextBox.Location = New-Object System.Drawing.Point(15,575)
$Contact_NewMailUser_Password2TextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_NewMailUser_Password2TextBox.PasswordChar = '*'
$Contact_NewMailUser_Password2TextBox.TabIndex = 0
$Contact_NewMailUser_Password2TextBox.ForeColor = "Blue"
$Contact_NewMailUser_Password2TextBox.Height = 80

$Contact_NewMailUser_PasswordMustChange = New-Object System.Windows.Forms.Checkbox 
$Contact_NewMailUser_PasswordMustChange.Location = New-Object System.Drawing.Point(15,605) 
$Contact_NewMailUser_PasswordMustChange.AutoSize = $true
$Contact_NewMailUser_PasswordMustChange.TabIndex = 0
$Contact_NewMailUser_PasswordMustChange.Text = "User must change password at next logon"
$Contact_NewMailUser_PasswordMustChange.ForeColor = "Black"

$Contact_NewMailUser_UserDisabled = New-Object System.Windows.Forms.Checkbox 
$Contact_NewMailUser_UserDisabled.Location = New-Object System.Drawing.Point(15,630) 
$Contact_NewMailUser_UserDisabled.AutoSize = $true
$Contact_NewMailUser_UserDisabled.TabIndex = 0
$Contact_NewMailUser_UserDisabled.Text = "User is disabled"
$Contact_NewMailUser_UserDisabled.ForeColor = "Black"


function Contact_NewMailUserCheckbox_function(){
    if ($Contact_NewMailUserCheckbox.checked -eq $true){
        $Contact_ExistingMailUserCheckbox.Enabled = $false
        $Contact_MailUserCheckBox.Enabled = $false
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUserCheckboxInfo)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_FirstNameLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_FirstNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_LastNameLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_LastNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_DisplayNameLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_DisplayNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_OrganizationalUnitLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_OrganizationalUnitDropMenu)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_UPNLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_UPNTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_UPNDomainTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_DescriptionLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_DescriptionTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_DepartmentLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_DepartmentTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_ExternalAdressLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_ExternalAdressTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_Password1Label)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_Password1TextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_Password2Label)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_Password2TextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_PasswordMustChange)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_NewMailUser_UserDisabled)

        $Tab4_contacts_Panel_1.Controls.Add($Create_NewMailUser_Button) 
        }
    else {
        $Contact_ExistingMailUserCheckbox.Enabled = $true
        $Contact_MailUserCheckBox.Enabled = $true
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUserCheckboxInfo)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_FirstNameLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_FirstNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_LastNameLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_LastNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_DisplayNameLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_DisplayNameTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_OrganizationalUnitLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_OrganizationalUnitDropMenu)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_UPNLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_UPNTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_UPNDomainTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_DescriptionLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_DescriptionTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_DepartmentLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_DepartmentTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_ExternalAdressLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_ExternalAdressTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_Password1Label)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_Password1TextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_Password2Label)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_Password2TextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_PasswordMustChange)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_NewMailUser_UserDisabled)

        $Tab4_contacts_Panel_1.Controls.Remove($Create_NewMailUser_Button) 
    }
}


#####  nacrtaj existing i functioon

$Contact_ExistingMailUserLabel = New-Object System.Windows.Forms.Label
$Contact_ExistingMailUserLabel.Location = New-Object System.Drawing.Point(15,145)
$Contact_ExistingMailUserLabel.Size = New-Object System.Drawing.Size(250,20)
$Contact_ExistingMailUserLabel.TabIndex = 0
$Contact_ExistingMailUserLabel.Text = "samaccountname:"
$Contact_ExistingMailUserLabel.ForeColor = "Black"

$Contact_ExistingMailUserTextBox = New-Object System.Windows.Forms.TextBox
$Contact_ExistingMailUserTextBox.Location = New-Object System.Drawing.Point(15,165)
$Contact_ExistingMailUserTextBox.Size = New-Object System.Drawing.Size(300,30)
$Contact_ExistingMailUserTextBox.TabIndex = 0
$Contact_ExistingMailUserTextBox.ForeColor = "Blue"

$Contact_ExistingMailUserCheckButton = New-Object System.Windows.Forms.Button
$Contact_ExistingMailUserCheckButton.Location = New-Object System.Drawing.Point(350,165)
$Contact_ExistingMailUserCheckButton.Size = New-Object System.Drawing.Size(165,23)
$Contact_ExistingMailUserCheckButton.TabIndex = 0
$Contact_ExistingMailUserCheckButton.Text = "Get-ADUser"
$Contact_ExistingMailUserCheckButton.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#e1f0ff")
$Contact_ExistingMailUserCheckButton.Add_Click({Get-ADUser_function})

$Contact_ExistingMailUser_ExternalAdressLabel = New-Object System.Windows.Forms.Label
$Contact_ExistingMailUser_ExternalAdressLabel.Location = New-Object System.Drawing.Point(15,190)
$Contact_ExistingMailUser_ExternalAdressLabel.Size = New-Object System.Drawing.Point(250,20)
$Contact_ExistingMailUser_ExternalAdressLabel.TabIndex = 0
$Contact_ExistingMailUser_ExternalAdressLabel.Text = "External email address:"
$Contact_ExistingMailUser_ExternalAdressLabel.ForeColor = "Black"

$Contact_ExistingMailUser_ExternalAdressTextBox = New-Object System.Windows.Forms.TextBox 
$Contact_ExistingMailUser_ExternalAdressTextBox.Location = New-Object System.Drawing.Point(15,210)
$Contact_ExistingMailUser_ExternalAdressTextBox.Size = New-Object System.Drawing.Size(500,30)
$Contact_ExistingMailUser_ExternalAdressTextBox.TabIndex = 0
$Contact_ExistingMailUser_ExternalAdressTextBox.ForeColor = "Blue"
function Contact_ExistingMailUserCheckbox_function(){
    if ($Contact_ExistingMailUserCheckbox.checked -eq $true){
        $Contact_NewMailUserCheckbox.Enabled = $false
        $Contact_MailUserCheckBox.Enabled = $false
        $Tab4_contacts_Panel_1.Controls.Add($Contact_ExistingMailUserCheckboxInfo)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_ExistingMailUserLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_ExistingMailUserTextBox)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_ExistingMailUserCheckButton)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_ExistingMailUser_ExternalAdressLabel)
        $Tab4_contacts_Panel_1.Controls.Add($Contact_ExistingMailUser_ExternalAdressTextBox)

        $Tab4_contacts_Panel_1.Controls.Add($Create_NewMailContact_Button) 
        }
    else {
        $Contact_NewMailUserCheckbox.Enabled = $true 
        $Contact_MailUserCheckBox.Enabled = $true
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_ExistingMailUserCheckboxInfo)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_ExistingMailUserLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_ExistingMailUserTextBox)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_ExistingMailUserCheckButton)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_ExistingMailUser_ExternalAdressLabel)
        $Tab4_contacts_Panel_1.Controls.Remove($Contact_ExistingMailUser_ExternalAdressTextBox)

        $Tab4_contacts_Panel_1.Controls.Remove($Create_NewMailContact_Button) 
    }
}



#------------- TAB 5 - convert -------------------------------------------------------------------------------------------

# Panel (for scoll bar to work)
$Tab5_convert_Panel_1 = New-Object System.Windows.Forms.Panel
$Tab5_convert_Panel_1.Location = New-Object System.Drawing.Point(15,20) 
$Tab5_convert_Panel_1.size = New-Object System.Drawing.Size(700,420)
$Tab5_convert_Panel_1.Dock = "Fill" 
$Tab5_convert_Panel_1.ColumnCount = 0
$Tab5_convert_Panel_1.RowCount = 0
$Tab5_convert_Panel_1.BorderStyle = "None"
$Tab5_convert_Panel_1.AutoSize = $true
$Tab5_convert_Panel_1.AutoScroll = $true
$Tab5_convert_Panel_1.Multiline = $true
$Tab5_convert_Panel_1.ScrollBars = "vertical"
$Tab5_convert.controls.add($Tab5_convert_Panel_1)


# Mailbox image
$Convert_iconBase64 = "
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
KKKKACiiigAooooAKKKKAP/2Q==
"
$Convert_iconBytes = [Convert]::FromBase64String($Convert_iconBase64)
# initialize a Memory stream holding the bytes
#$Maibox_stream = [System.IO.MemoryStream]::new($Mailbox_iconBytes, 0, $Mailbox_iconBytes.Length)
#$Tab1_mailboxes_Panel_1.Icon  = [System.Drawing.Icon]::FromHandle(([System.Drawing.Bitmap]::new($Maibox_stream).GetHIcon()))

$Convert_PictureBox = new-object Windows.Forms.PictureBox
$Convert_PictureBox.Location = New-Object System.Drawing.Size(570,30)
$Convert_PictureBox.Size = New-Object System.Drawing.Size(100,100)
$Convert_PictureBox.Image = $Convert_iconBytes
$Tab5_convert_Panel_1.controls.add($Convert_PictureBox)

#------------- TAB 6 - migration -----------------------------------------------------------------------------------------

# Panel (for scoll bar to work)
$Tab6_migration_Panel_1 = New-Object System.Windows.Forms.Panel
$Tab6_migration_Panel_1.Location = New-Object System.Drawing.Point(15,20) 
$Tab6_migration_Panel_1.size = New-Object System.Drawing.Size(700,420)
$Tab6_migration_Panel_1.Dock = "Fill" 
$Tab6_migration_Panel_1.ColumnCount = 0
$Tab6_migration_Panel_1.RowCount = 0
$Tab6_migration_Panel_1.BorderStyle = "None"
$Tab6_migration_Panel_1.AutoSize = $true
$Tab6_migration_Panel_1.AutoScroll = $true
$Tab6_migration_Panel_1.Multiline = $true
$Tab6_migration_Panel_1.ScrollBars = "vertical"
$Tab6_migration.controls.add($Tab6_migration_Panel_1)


# Mailbox image
$Migration_iconBase64 = "
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
"
$Migration_iconBytes = [Convert]::FromBase64String($Migration_iconBase64)
# initialize a Memory stream holding the bytes
#$Maibox_stream = [System.IO.MemoryStream]::new($Mailbox_iconBytes, 0, $Mailbox_iconBytes.Length)
#$Tab1_mailboxes_Panel_1.Icon  = [System.Drawing.Icon]::FromHandle(([System.Drawing.Bitmap]::new($Maibox_stream).GetHIcon()))

$Migration_PictureBox = new-object Windows.Forms.PictureBox
$Migration_PictureBox.Location = New-Object System.Drawing.Size(569,30)
$Migration_PictureBox.Size = New-Object System.Drawing.Size(100,100)
$Migration_PictureBox.Image = $Migration_iconBytes
$Tab6_migration_Panel_1.controls.add($Migration_PictureBox)

#------------- TAB 7 - about ---------------------------------------------------------------------------------------------

# Panel (for scoll bar to work)
$Tab7_About_Panel_1 = New-Object System.Windows.Forms.Panel
$Tab7_About_Panel_1.Location = New-Object System.Drawing.Point(15,20) 
$Tab7_About_Panel_1.size = New-Object System.Drawing.Size(700,420)
$Tab7_About_Panel_1.Dock = "Fill" 
$Tab7_About_Panel_1.ColumnCount = 0
$Tab7_About_Panel_1.RowCount = 0
$Tab7_About_Panel_1.BorderStyle = "None"
$Tab7_About_Panel_1.AutoSize = $true
$Tab7_About_Panel_1.AutoScroll = $true
$Tab7_About_Panel_1.Multiline = $true
$Tab7_About_Panel_1.ScrollBars = "vertical"
$Tab7_about.controls.add($Tab7_About_Panel_1)


# Mailbox image
$About_iconBase64 = "
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
"

$About_iconBytes = [Convert]::FromBase64String($About_iconBase64)
$About_PictureBox = new-object Windows.Forms.PictureBox
$About_PictureBox.Location = New-Object System.Drawing.Size(569,30)
$About_PictureBox.Size = New-Object System.Drawing.Size(100,100)
$About_PictureBox.Image = $About_iconBytes
$Tab7_About_Panel_1.controls.add($About_PictureBox)


#skripa lokacija
$scriptPath = "github"
#$LastEditTime = 
$LastEditTime = "check if up to date with github"

#about
$About_text = New-Object System.Windows.Forms.Label
$About_text.Text = "
Version: $verzija
Location: $scriptPath
Last Edit: $LastEditTime
"
$About_text.TabIndex = 6
$About_text.Location = New-Object System.Drawing.Point(20,20)
$About_text.Size = New-Object System.Drawing.Size(680,80)
$About_text.AutoSize = $false
$Tab7_About_Panel_1.Controls.Add($About_text)

$ToDo_text = New-Object System.Windows.Forms.Label
$ToDo_text.Text = "
- install prerequisites (AD/Exchange)
- check for updates for prerequisites
- check for updates for the script
- 
"
$ToDo_text.TabIndex = 3
$ToDo_text.Location = New-Object System.Drawing.Point(20,100)
$ToDo_text.Size = New-Object System.Drawing.Size(680,200)
$ToDo_text.AutoSize = $false
$Tab7_About_Panel_1.Controls.Add($ToDo_text)

#>


#------------- GUI - DISPLAY EVERYTHING ----------------------------------------------------------------------------------
$main_form.ShowDialog()
